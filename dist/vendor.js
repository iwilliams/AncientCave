function RC4(t){this.s=new Array(256),this.i=0,this.j=0;for(var e=0;256>e;e++)this.s[e]=e;t&&this.mix(t)}function RNG(t){null==t?t=(Math.random()+Date.now()).toString():"function"==typeof t?(this.uniform=t,this.nextByte=function(){return~~(256*this.uniform())},t=null):"[object String]"!==Object.prototype.toString.call(t)&&(t=JSON.stringify(t)),this._normal=null,t?this._state=new RC4(t):this._state=null}(function(){var t,e,n,r,i,o,s,a,u,c,h,f,p,l,d,_,v,y,m,g={}.hasOwnProperty,w=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};o={is_unordered:!1,is_counting:!1,is_exclusive:!1,is_solitary:!1,prevent_default:!1,prevent_repeat:!1},y="meta alt option ctrl shift cmd".split(" "),_="ctrl",t={debug:!1};var b=function(t){var e,n;for(e in t)g.call(t,e)&&(n=t[e],!1!==n&&(this[e]=n));this.keys=this.keys||[],this.count=this.count||0};b.prototype.allows_key_repeat=function(){return!this.prevent_repeat&&"function"==typeof this.on_keydown},b.prototype.reset=function(){return this.count=0,this.keyup_fired=null};var k=function(t,e){var n,r;"undefined"!=typeof jQuery&&null!==jQuery&&t instanceof jQuery&&(1!==t.length&&d("Warning: your jQuery selector should have exactly one object."),t=t[0]),this.should_force_event_defaults=this.should_suppress_event_defaults=!1,this.sequence_delay=800,this._registered_combos=[],this._keys_down=[],this._active_combos=[],this._sequence=[],this._sequence_timer=null,this._prevent_capture=!1,this._defaults=e||{};for(n in o)g.call(o,n)&&(r=o[n],this._defaults[n]=this._defaults[n]||r);this.element=t||document.body,n=function(t,e,n){return t.addEventListener?t.addEventListener(e,n):t.attachEvent&&t.attachEvent("on"+e,n),n};var i=this;this.keydown_event=n(this.element,"keydown",function(t){return t=t||window.event,i._receive_input(t,!0),i._bug_catcher(t)});var s=this;this.keyup_event=n(this.element,"keyup",function(t){return t=t||window.event,s._receive_input(t,!1)});var a=this;this.blur_event=n(window,"blur",function(){var t,e,n,r;for(r=a._keys_down,e=0,n=r.length;n>e;e++)t=r[e],a._key_up(t,{});return a._keys_down=[]})};k.prototype.destroy=function(){var t;return t=function(t,e,n){return null!=t.removeEventListener?t.removeEventListener(e,n):null!=t.removeEvent?t.removeEvent("on"+e,n):void 0},t(this.element,"keydown",this.keydown_event),t(this.element,"keyup",this.keyup_event),t(window,"blur",this.blur_event)},k.prototype._bug_catcher=function(t){var e;return"cmd"===_&&0<=w.call(this._keys_down,"cmd")&&"cmd"!==(e=r(t.keyCode))&&"shift"!==e&&"alt"!==e&&"caps"!==e&&"tab"!==e?this._receive_input(t,!1):void 0},k.prototype._cmd_bug_check=function(t){return"cmd"===_&&0<=w.call(this._keys_down,"cmd")&&0>w.call(t,"cmd")?!1:!0},k.prototype._prevent_default=function(t,e){return(e||this.should_suppress_event_defaults)&&!this.should_force_event_defaults&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation)?t.stopPropagation():void 0},k.prototype._get_active_combos=function(t){var e,n;return e=[],n=s(this._keys_down,function(e){return e!==t}),n.push(t),this._match_combo_arrays(n,function(t){return function(n){return t._cmd_bug_check(n.keys)?e.push(n):void 0}}(this)),this._fuzzy_match_combo_arrays(n,function(t){return function(n){return 0<=w.call(e,n)||n.is_solitary||!t._cmd_bug_check(n.keys)?void 0:e.push(n)}}(this)),e},k.prototype._get_potential_combos=function(t){var e,n,r,i,o;for(n=[],o=this._registered_combos,r=0,i=o.length;i>r;r++)e=o[r],e.is_sequence||0<=w.call(e.keys,t)&&this._cmd_bug_check(e.keys)&&n.push(e);return n},k.prototype._add_to_active_combos=function(t){var e,n,r,i,o,s,a,u,c,h,f;if(s=!1,o=!0,r=!1,0<=w.call(this._active_combos,t))return!0;if(this._active_combos.length)for(i=a=0,h=this._active_combos.length;h>=0?h>a:a>h;i=h>=0?++a:--a)if((e=this._active_combos[i])&&e.is_exclusive&&t.is_exclusive){if(e=e.keys,!s)for(u=0,c=e.length;c>u;u++)if(n=e[u],s=!0,0>w.call(t.keys,n)){s=!1;break}if(o&&!s)for(f=t.keys,u=0,c=f.length;c>u;u++)if(n=f[u],o=!1,0>w.call(e,n)){o=!0;break}s&&(r?(e=this._active_combos.splice(i,1)[0],null!=e&&e.reset()):(e=this._active_combos.splice(i,1,t)[0],null!=e&&e.reset(),r=!0),o=!1)}return o&&this._active_combos.unshift(t),s||o},k.prototype._remove_from_active_combos=function(t){var e,n,r,i;for(n=r=0,i=this._active_combos.length;i>=0?i>r:r>i;n=i>=0?++r:--r)if(e=this._active_combos[n],e===t){t=this._active_combos.splice(n,1)[0],t.reset();break}},k.prototype._get_possible_sequences=function(){var t,e,n,r,i,o,a,u,c,h,f,p;for(r=[],h=this._registered_combos,o=0,c=h.length;c>o;o++)for(t=h[o],e=a=1,f=this._sequence.length;f>=1?f>=a:a>=f;e=f>=1?++a:--a)if(i=this._sequence.slice(-e),t.is_sequence){if(0>w.call(t.keys,"shift")&&(i=s(i,function(t){return"shift"!==t}),!i.length))continue;for(e=u=0,p=i.length;p>=0?p>u:u>p;e=p>=0?++u:--u){if(t.keys[e]!==i[e]){n=!1;break}n=!0}n&&r.push(t)}return r},k.prototype._add_key_to_sequence=function(t,e){var n,r,i,o;if(this._sequence.push(t),r=this._get_possible_sequences(),r.length){for(i=0,o=r.length;o>i;i++)n=r[i],this._prevent_default(e,n.prevent_default);this._sequence_timer&&clearTimeout(this._sequence_timer),-1<this.sequence_delay&&(this._sequence_timer=setTimeout(function(){return this._sequence=[]},this.sequence_delay))}else this._sequence=[]},k.prototype._get_sequence=function(t){var e,n,r,i,o,a,u,c,h,f,p,l;for(f=this._registered_combos,a=0,h=f.length;h>a;a++)if(e=f[a],e.is_sequence){for(n=u=1,p=this._sequence.length;p>=1?p>=u:u>=p;n=p>=1?++u:--u)if(o=s(this._sequence,function(t){return 0<=w.call(e.keys,"shift")?!0:"shift"!==t}).slice(-n),e.keys.length===o.length)for(n=c=0,l=o.length;l>=0?l>c:c>l;n=l>=0?++c:--c)if(i=o[n],!(0>w.call(e.keys,"shift")&&"shift"===i||"shift"===t&&0>w.call(e.keys,"shift"))){if(e.keys[n]!==i){r=!1;break}r=!0}if(r)return e.is_exclusive&&(this._sequence=[]),e}return!1},k.prototype._receive_input=function(t,e){var n;if(this._prevent_capture)this._keys_down.length&&(this._keys_down=[]);else if(n=r(t.keyCode),(e||this._keys_down.length||!("alt"===n||n===_))&&n)return e?this._key_down(n,t):this._key_up(n,t)},k.prototype._fire=function(t,e,n,r){return"function"==typeof e["on_"+t]&&this._prevent_default(n,!0!==e["on_"+t].call(e["this"],n,e.count,r)),"release"===t&&(e.count=0),"keyup"===t?e.keyup_fired=!0:void 0},k.prototype._match_combo_arrays=function(t,r){var i,o,s,a;for(a=this._registered_combos,o=0,s=a.length;s>o;o++)i=a[o],(!i.is_unordered&&n(t,i.keys)||i.is_unordered&&e(t,i.keys))&&r(i)},k.prototype._fuzzy_match_combo_arrays=function(t,e){var n,r,i,o;for(o=this._registered_combos,r=0,i=o.length;i>r;r++)n=o[r],(!n.is_unordered&&c(n.keys,t)||n.is_unordered&&u(n.keys,t))&&e(n)},k.prototype._keys_remain=function(t){var e,n,r,i;for(i=t.keys,n=0,r=i.length;r>n;n++)if(t=i[n],0<=w.call(this._keys_down,t)){e=!0;break}return e},k.prototype._key_down=function(t,e){var n,r,o,s,a;(n=i(t,e))&&(t=n),this._add_key_to_sequence(t,e),(n=this._get_sequence(t))&&this._fire("keydown",n,e);for(o in v)n=v[o],e[n]&&(o===t||0<=w.call(this._keys_down,o)||this._keys_down.push(o));for(o in v)if(n=v[o],o!==t&&0<=w.call(this._keys_down,o)&&!e[n]&&!("cmd"===o&&"cmd"!==_))for(n=r=0,s=this._keys_down.length;s>=0?s>r:r>s;n=s>=0?++r:--r)this._keys_down[n]===o&&this._keys_down.splice(n,1);for(r=this._get_active_combos(t),o=this._get_potential_combos(t),s=0,a=r.length;a>s;s++)n=r[s],this._handle_combo_down(n,o,t,e);if(o.length)for(r=0,s=o.length;s>r;r++)n=o[r],this._prevent_default(e,n.prevent_default);0>w.call(this._keys_down,t)&&this._keys_down.push(t)},k.prototype._handle_combo_down=function(t,e,n,r){var i,o,s,a,u;if(0>w.call(t.keys,n))return!1;if(this._prevent_default(r,t&&t.prevent_default),i=!1,0<=w.call(this._keys_down,n)&&(i=!0,!t.allows_key_repeat()))return!1;if(s=this._add_to_active_combos(t,n),n=t.keyup_fired=!1,t.is_exclusive)for(a=0,u=e.length;u>a;a++)if(o=e[a],o.is_exclusive&&o.keys.length>t.keys.length){n=!0;break}return!n&&(t.is_counting&&"function"==typeof t.on_keydown&&(t.count+=1),s)?this._fire("keydown",t,r,i):void 0},k.prototype._key_up=function(t,e){var n,r,o,s,a,u;if(n=t,(o=i(t,e))&&(t=o),o=l[n],e.shiftKey?o&&0<=w.call(this._keys_down,o)||(t=n):n&&0<=w.call(this._keys_down,n)||(t=o),(s=this._get_sequence(t))&&this._fire("keyup",s,e),0>w.call(this._keys_down,t))return!1;for(s=a=0,u=this._keys_down.length;u>=0?u>a:a>u;s=u>=0?++a:--a)if((r=this._keys_down[s])===t||r===o||r===n){this._keys_down.splice(s,1);break}for(r=this._active_combos.length,o=[],u=this._active_combos,s=0,a=u.length;a>s;s++)n=u[s],0<=w.call(n.keys,t)&&o.push(n);for(s=0,a=o.length;a>s;s++)n=o[s],this._handle_combo_up(n,e,t);if(r>1)for(a=this._active_combos,r=0,s=a.length;s>r;r++)n=a[r],void 0===n||0<=w.call(o,n)||this._keys_remain(n)||this._remove_from_active_combos(n)},k.prototype._handle_combo_up=function(t,n,r){var i,o;this._prevent_default(n,t&&t.prevent_default),o=this._keys_remain(t),t.keyup_fired||(i=this._keys_down.slice(),i.push(r),t.is_solitary&&!e(i,t.keys))||(this._fire("keyup",t,n),t.is_counting&&"function"==typeof t.on_keyup&&"function"!=typeof t.on_keydown&&(t.count+=1)),o||(this._fire("release",t,n),this._remove_from_active_combos(t))},k.prototype.simple_combo=function(t,e){return this.register_combo({keys:t,on_keydown:e})},k.prototype.counting_combo=function(t,e){return this.register_combo({keys:t,is_counting:!0,is_unordered:!1,on_keydown:e})},k.prototype.sequence_combo=function(t,e){return this.register_combo({keys:t,on_keydown:e,is_sequence:!0,is_exclusive:!0})},k.prototype.register_combo=function(t){var e,n,r;"string"==typeof t.keys&&(t.keys=t.keys.split(" ")),r=this._defaults;for(e in r)g.call(r,e)&&(n=r[e],void 0===t[e]&&(t[e]=n));return t=new b(t),m(t)?(this._registered_combos.push(t),t):void 0},k.prototype.register_many=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(this.register_combo(e));return i},k.prototype.unregister_combo=function(t){var r,i,o,s,a,u;if(!t)return!1;var c=this;if(i=function(t){var e,n,r,i;for(i=[],e=n=0,r=c._registered_combos.length;r>=0?r>n:n>r;e=r>=0?++n:--n){if(t===c._registered_combos[e]){c._registered_combos.splice(e,1);break}i.push(void 0)}return i},t instanceof b)return i(t);for("string"==typeof t&&(t=t.split(" ")),a=this._registered_combos,u=[],o=0,s=a.length;s>o;o++)r=a[o],null!=r&&(r.is_unordered&&e(t,r.keys)||!r.is_unordered&&n(t,r.keys)?u.push(i(r)):u.push(void 0));return u},k.prototype.unregister_many=function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(this.unregister_combo(e));return i},k.prototype.get_registered_combos=function(){return this._registered_combos},k.prototype.reset=function(){return this._registered_combos=[]},k.prototype.listen=function(){return this._prevent_capture=!1},k.prototype.stop_listening=function(){return this._prevent_capture=!0},k.prototype.get_meta_key=function(){return _},t.Listener=k,r=function(t){return p[t]},s=function(t,e){var n;if(t.filter)return t.filter(e);var r,i,o;for(o=[],r=0,i=t.length;i>r;r++)n=t[r],e(n)&&o.push(n);return o},e=function(t,e){var n,r,i;if(t.length!==e.length)return!1;for(r=0,i=t.length;i>r;r++)if(n=t[r],!(0<=w.call(e,n)))return!1;return!0},n=function(t,e){var n,r,i;if(t.length!==e.length)return!1;for(n=r=0,i=t.length;i>=0?i>r:r>i;n=i>=0?++r:--r)if(t[n]!==e[n])return!1;return!0},u=function(t,e){var n,r,i;for(r=0,i=t.length;i>r;r++)if(n=t[r],0>w.call(e,n))return!1;return!0},a=Array.prototype.indexOf||function(t,e){var n,r,i;for(n=r=0,i=t.length;i>=0?i>=r:r>=i;n=i>=0?++r:--r)if(t[n]===e)return n;return-1},c=function(t,e){var n,r,i,o;for(i=r=0,o=t.length;o>i;i++){if(n=t[i],n=a.call(e,n),!(n>=r))return!1;r=n}return!0},d=function(){return t.debug?console.log.apply(console,arguments):void 0},h=function(t){var e,n,r;e=!1;for(r in p)if(n=p[r],t===n){e=!0;break}if(!e)for(r in l)if(n=l[r],t===n){e=!0;break}return e},m=function(t){var e,n,r,i,s,u,c;for(s=!0,t.keys.length||d("You're trying to bind a combo with no keys:",t),n=u=0,c=t.keys.length;c>=0?c>u:u>c;n=c>=0?++u:--u)r=t.keys[n],(e=f[r])&&(r=t.keys[n]=e),"meta"===r&&t.keys.splice(n,1,_),"cmd"===r&&d('Warning: use the "meta" key rather than "cmd" for Windows compatibility');for(c=t.keys,e=0,u=c.length;u>e;e++)r=c[e],h(r)||(d('Do not recognize the key "'+r+'"'),s=!1);if(0<=w.call(t.keys,"meta")||0<=w.call(t.keys,"cmd")){for(e=t.keys.slice(),u=0,c=y.length;c>u;u++)r=y[u],-1<(n=a.call(e,r))&&e.splice(n,1);1<e.length&&(d("META and CMD key combos cannot have more than 1 non-modifier keys",t,e),s=!1)}for(i in t)"undefined"===o[i]&&d("The property "+i+" is not a valid combo property. Your combo has still been registered.");return s},i=function(t,e){var n;return e.shiftKey?(n=l[t],null!=n?n:!1):!1},v={cmd:"metaKey",ctrl:"ctrlKey",shift:"shiftKey",alt:"altKey"},f={escape:"esc",control:"ctrl",command:"cmd","break":"pause",windows:"cmd",option:"alt",caps_lock:"caps",apostrophe:"'",semicolon:";",tilde:"~",accent:"`",scroll_lock:"scroll",num_lock:"num"},l={"/":"?",".":">",",":"<","'":'"',";":":","[":"{","]":"}","\\":"|","`":"~","=":"+","-":"_",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")"},p={0:"\\",8:"backspace",9:"tab",12:"num",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"print",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"cmd",92:"cmd",93:"cmd",96:"num_0",97:"num_1",98:"num_2",99:"num_3",100:"num_4",101:"num_5",102:"num_6",103:"num_7",104:"num_8",105:"num_9",106:"num_multiply",107:"num_add",108:"num_enter",109:"num_subtract",110:"num_decimal",111:"num_divide",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",124:"print",144:"num",145:"scroll",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"`",224:"cmd",225:"alt",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},t._keycode_dictionary=p,t._is_array_in_array_sorted=c,-1!==navigator.userAgent.indexOf("Mac OS X")&&(_="cmd"),-1!==navigator.userAgent.indexOf("Opera")&&(p[17]="cmd"),"function"==typeof define&&define.amd?define([],function(){return t}):"undefined"!=typeof exports&&null!==exports?exports.keypress=t:window.keypress=t}).call(this),!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return i(n?n:t)},h,h.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e){e.exports.RTCSessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription,e.exports.RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,e.exports.RTCIceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate},{}],2:[function(t,e){function n(t,e,s){return this instanceof n?(i.call(this),this.options=r.extend({serialization:"binary",reliable:!1},s),this.open=!1,this.type="data",this.peer=t,this.provider=e,this.id=this.options.connectionId||n._idPrefix+r.randomToken(),this.label=this.options.label||this.id,this.metadata=this.options.metadata,this.serialization=this.options.serialization,this.reliable=this.options.reliable,this._buffer=[],this._buffering=!1,this.bufferSize=0,this._chunkedData={},this.options._payload&&(this._peerBrowser=this.options._payload.browser),void o.startConnection(this,this.options._payload||{originator:!0})):new n(t,e,s)}var r=t("./util"),i=t("eventemitter3"),o=t("./negotiator"),s=t("reliable");r.inherits(n,i),n._idPrefix="dc_",n.prototype.initialize=function(t){this._dc=this.dataChannel=t,this._configureDataChannel()},n.prototype._configureDataChannel=function(){var t=this;r.supports.sctp&&(this._dc.binaryType="arraybuffer"),this._dc.onopen=function(){r.log("Data channel connection success"),t.open=!0,t.emit("open")},!r.supports.sctp&&this.reliable&&(this._reliable=new s(this._dc,r.debug)),this._reliable?this._reliable.onmessage=function(e){t.emit("data",e)}:this._dc.onmessage=function(e){t._handleDataMessage(e)},this._dc.onclose=function(){r.log("DataChannel closed for:",t.peer),t.close()}},n.prototype._handleDataMessage=function(t){var e=this,n=t.data,i=n.constructor;if("binary"===this.serialization||"binary-utf8"===this.serialization){if(i===Blob)return void r.blobToArrayBuffer(n,function(t){n=r.unpack(t),e.emit("data",n)});if(i===ArrayBuffer)n=r.unpack(n);else if(i===String){var o=r.binaryStringToArrayBuffer(n);n=r.unpack(o)}}else"json"===this.serialization&&(n=JSON.parse(n));if(n.__peerData){var s=n.__peerData,a=this._chunkedData[s]||{data:[],count:0,total:n.total};return a.data[n.n]=n.data,a.count+=1,a.total===a.count&&(delete this._chunkedData[s],n=new Blob(a.data),this._handleDataMessage({data:n})),void(this._chunkedData[s]=a)}this.emit("data",n)},n.prototype.close=function(){this.open&&(this.open=!1,o.cleanup(this),this.emit("close"))},n.prototype.send=function(t,e){if(!this.open)return void this.emit("error",new Error("Connection is not open. You should listen for the `open` event before sending messages."));if(this._reliable)return void this._reliable.send(t);var n=this;if("json"===this.serialization)this._bufferedSend(JSON.stringify(t));else if("binary"===this.serialization||"binary-utf8"===this.serialization){var i=r.pack(t),o=r.chunkedBrowsers[this._peerBrowser]||r.chunkedBrowsers[r.browser];if(o&&!e&&i.size>r.chunkedMTU)return void this._sendChunks(i);r.supports.sctp?r.supports.binaryBlob?this._bufferedSend(i):r.blobToArrayBuffer(i,function(t){n._bufferedSend(t)}):r.blobToBinaryString(i,function(t){n._bufferedSend(t)})}else this._bufferedSend(t)},n.prototype._bufferedSend=function(t){(this._buffering||!this._trySend(t))&&(this._buffer.push(t),this.bufferSize=this._buffer.length)},n.prototype._trySend=function(t){try{this._dc.send(t)}catch(e){this._buffering=!0;var n=this;return setTimeout(function(){n._buffering=!1,n._tryBuffer()},100),!1}return!0},n.prototype._tryBuffer=function(){if(0!==this._buffer.length){var t=this._buffer[0];this._trySend(t)&&(this._buffer.shift(),this.bufferSize=this._buffer.length,this._tryBuffer())}},n.prototype._sendChunks=function(t){for(var e=r.chunk(t),n=0,i=e.length;i>n;n+=1){var t=e[n];this.send(t,!0)}},n.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case"ANSWER":this._peerBrowser=e.browser,o.handleSDP(t.type,this,e.sdp);break;case"CANDIDATE":o.handleCandidate(this,e.candidate);break;default:r.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},e.exports=n},{"./negotiator":5,"./util":8,eventemitter3:9,reliable:12}],3:[function(t){window.Socket=t("./socket"),window.MediaConnection=t("./mediaconnection"),window.DataConnection=t("./dataconnection"),window.Peer=t("./peer"),window.RTCPeerConnection=t("./adapter").RTCPeerConnection,window.RTCSessionDescription=t("./adapter").RTCSessionDescription,window.RTCIceCandidate=t("./adapter").RTCIceCandidate,window.Negotiator=t("./negotiator"),window.util=t("./util"),window.BinaryPack=t("js-binarypack")},{"./adapter":1,"./dataconnection":2,"./mediaconnection":4,"./negotiator":5,"./peer":6,"./socket":7,"./util":8,"js-binarypack":10}],4:[function(t,e){function n(t,e,s){return this instanceof n?(i.call(this),this.options=r.extend({},s),this.open=!1,this.type="media",this.peer=t,this.provider=e,this.metadata=this.options.metadata,this.localStream=this.options._stream,this.id=this.options.connectionId||n._idPrefix+r.randomToken(),void(this.localStream&&o.startConnection(this,{_stream:this.localStream,originator:!0}))):new n(t,e,s)}var r=t("./util"),i=t("eventemitter3"),o=t("./negotiator");r.inherits(n,i),n._idPrefix="mc_",n.prototype.addStream=function(t){r.log("Receiving stream",t),this.remoteStream=t,this.emit("stream",t)},n.prototype.handleMessage=function(t){var e=t.payload;switch(t.type){case"ANSWER":o.handleSDP(t.type,this,e.sdp),this.open=!0;break;case"CANDIDATE":o.handleCandidate(this,e.candidate);break;default:r.warn("Unrecognized message type:",t.type,"from peer:",this.peer)}},n.prototype.answer=function(t){if(this.localStream)return void r.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");this.options._payload._stream=t,this.localStream=t,o.startConnection(this,this.options._payload);for(var e=this.provider._getMessages(this.id),n=0,i=e.length;i>n;n+=1)this.handleMessage(e[n]);this.open=!0},n.prototype.close=function(){this.open&&(this.open=!1,o.cleanup(this),this.emit("close"))},e.exports=n},{"./negotiator":5,"./util":8,eventemitter3:9}],5:[function(t,e){var n=t("./util"),r=t("./adapter").RTCPeerConnection,i=t("./adapter").RTCSessionDescription,o=t("./adapter").RTCIceCandidate,s={pcs:{data:{},media:{}},queue:[]};s._idPrefix="pc_",s.startConnection=function(t,e){var r=s._getPeerConnection(t,e);if("media"===t.type&&e._stream&&r.addStream(e._stream),t.pc=t.peerConnection=r,e.originator){if("data"===t.type){var i={};n.supports.sctp||(i={reliable:e.reliable});var o=r.createDataChannel(t.label,i);t.initialize(o)}n.supports.onnegotiationneeded||s._makeOffer(t)}else s.handleSDP("OFFER",t,e.sdp)},s._getPeerConnection=function(t,e){s.pcs[t.type]||n.error(t.type+" is not a valid connection type. Maybe you overrode the `type` property somewhere."),s.pcs[t.type][t.peer]||(s.pcs[t.type][t.peer]={});var r;return s.pcs[t.type][t.peer],e.pc&&(r=s.pcs[t.type][t.peer][e.pc]),r&&"stable"===r.signalingState||(r=s._startPeerConnection(t)),r},s._startPeerConnection=function(t){n.log("Creating RTCPeerConnection.");var e=s._idPrefix+n.randomToken(),i={};"data"!==t.type||n.supports.sctp?"media"===t.type&&(i={optional:[{DtlsSrtpKeyAgreement:!0}]}):i={optional:[{RtpDataChannels:!0}]};var o=new r(t.provider.options.config,i);return s.pcs[t.type][t.peer][e]=o,s._setupListeners(t,o,e),o},s._setupListeners=function(t,e){var r=t.peer,i=t.id,o=t.provider;n.log("Listening for ICE candidates."),e.onicecandidate=function(e){e.candidate&&(n.log("Received ICE candidates for:",t.peer),o.socket.send({type:"CANDIDATE",payload:{candidate:e.candidate,type:t.type,connectionId:t.id},dst:r}))},e.oniceconnectionstatechange=function(){switch(e.iceConnectionState){case"disconnected":case"failed":n.log("iceConnectionState is disconnected, closing connections to "+r),t.close();break;case"completed":e.onicecandidate=n.noop}},e.onicechange=e.oniceconnectionstatechange,n.log("Listening for `negotiationneeded`"),e.onnegotiationneeded=function(){n.log("`negotiationneeded` triggered"),"stable"==e.signalingState?s._makeOffer(t):n.log("onnegotiationneeded triggered when not stable. Is another connection being established?")},n.log("Listening for data channel"),e.ondatachannel=function(t){n.log("Received data channel");var e=t.channel,s=o.getConnection(r,i);s.initialize(e)},n.log("Listening for remote stream"),e.onaddstream=function(t){n.log("Received remote stream");var e=t.stream,s=o.getConnection(r,i);"media"===s.type&&s.addStream(e)}},s.cleanup=function(t){n.log("Cleaning up PeerConnection to "+t.peer);var e=t.pc;!e||"closed"===e.readyState&&"closed"===e.signalingState||(e.close(),t.pc=null)},s._makeOffer=function(t){var e=t.pc;e.createOffer(function(r){n.log("Created offer."),!n.supports.sctp&&"data"===t.type&&t.reliable&&(r.sdp=Reliable.higherBandwidthSDP(r.sdp)),e.setLocalDescription(r,function(){n.log("Set localDescription: offer","for:",t.peer),t.provider.socket.send({type:"OFFER",payload:{sdp:r,type:t.type,label:t.label,connectionId:t.id,reliable:t.reliable,serialization:t.serialization,metadata:t.metadata,browser:n.browser},dst:t.peer})},function(e){t.provider.emitError("webrtc",e),n.log("Failed to setLocalDescription, ",e)})},function(e){t.provider.emitError("webrtc",e),n.log("Failed to createOffer, ",e)},t.options.constraints)},s._makeAnswer=function(t){var e=t.pc;e.createAnswer(function(r){n.log("Created answer."),!n.supports.sctp&&"data"===t.type&&t.reliable&&(r.sdp=Reliable.higherBandwidthSDP(r.sdp)),e.setLocalDescription(r,function(){n.log("Set localDescription: answer","for:",t.peer),t.provider.socket.send({type:"ANSWER",payload:{sdp:r,type:t.type,connectionId:t.id,browser:n.browser},dst:t.peer})},function(e){t.provider.emitError("webrtc",e),n.log("Failed to setLocalDescription, ",e)})},function(e){t.provider.emitError("webrtc",e),n.log("Failed to create answer, ",e)})},s.handleSDP=function(t,e,r){r=new i(r);var o=e.pc;n.log("Setting remote description",r),o.setRemoteDescription(r,function(){n.log("Set remoteDescription:",t,"for:",e.peer),"OFFER"===t&&s._makeAnswer(e)},function(t){e.provider.emitError("webrtc",t),n.log("Failed to setRemoteDescription, ",t)})},s.handleCandidate=function(t,e){var r=e.candidate,i=e.sdpMLineIndex;t.pc.addIceCandidate(new o({sdpMLineIndex:i,candidate:r})),n.log("Added ICE candidate for:",t.peer)},e.exports=s},{"./adapter":1,"./util":8}],6:[function(t,e){function n(t,e){return this instanceof n?(i.call(this),t&&t.constructor==Object?(e=t,t=void 0):t&&(t=t.toString()),e=r.extend({debug:0,host:r.CLOUD_HOST,port:r.CLOUD_PORT,key:"peerjs",path:"/",token:r.randomToken(),config:r.defaultConfig},e),this.options=e,"/"===e.host&&(e.host=window.location.hostname),"/"!==e.path[0]&&(e.path="/"+e.path),"/"!==e.path[e.path.length-1]&&(e.path+="/"),void 0===e.secure&&e.host!==r.CLOUD_HOST&&(e.secure=r.isSecure()),e.logFunction&&r.setLogFunction(e.logFunction),r.setLogLevel(e.debug),r.supports.audioVideo||r.supports.data?r.validateId(t)?r.validateKey(e.key)?e.secure&&"0.peerjs.com"===e.host?void this._delayedAbort("ssl-unavailable","The cloud server currently does not support HTTPS. Please run your own PeerServer to use HTTPS."):(this.destroyed=!1,this.disconnected=!1,this.open=!1,this.connections={},this._lostMessages={},this._initializeServerConnection(),void(t?this._initialize(t):this._retrieveId())):void this._delayedAbort("invalid-key",'API KEY "'+e.key+'" is invalid'):void this._delayedAbort("invalid-id",'ID "'+t+'" is invalid'):void this._delayedAbort("browser-incompatible","The current browser does not support WebRTC")):new n(t,e)}var r=t("./util"),i=t("eventemitter3"),o=t("./socket"),s=t("./mediaconnection"),a=t("./dataconnection");r.inherits(n,i),n.prototype._initializeServerConnection=function(){var t=this;this.socket=new o(this.options.secure,this.options.host,this.options.port,this.options.path,this.options.key),this.socket.on("message",function(e){t._handleMessage(e)}),this.socket.on("error",function(e){t._abort("socket-error",e)}),this.socket.on("disconnected",function(){t.disconnected||(t.emitError("network","Lost connection to server."),t.disconnect())}),this.socket.on("close",function(){t.disconnected||t._abort("socket-closed","Underlying socket is already closed.")})},n.prototype._retrieveId=function(){var t=this,e=new XMLHttpRequest,n=this.options.secure?"https://":"http://",i=n+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/id",o="?ts="+(new Date).getTime()+Math.random();i+=o,e.open("get",i,!0),e.onerror=function(e){r.error("Error retrieving ID",e);var n="";"/"===t.options.path&&t.options.host!==r.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),t._abort("server-error","Could not get an ID from the server."+n)},e.onreadystatechange=function(){return 4===e.readyState?200!==e.status?void e.onerror():void t._initialize(e.responseText):void 0},e.send(null)},n.prototype._initialize=function(t){this.id=t,this.socket.start(this.id,this.options.token)},n.prototype._handleMessage=function(t){var e,n=t.type,i=t.payload,o=t.src;switch(n){case"OPEN":this.emit("open",this.id),this.open=!0;break;case"ERROR":this._abort("server-error",i.msg);break;case"ID-TAKEN":this._abort("unavailable-id","ID `"+this.id+"` is taken");break;case"INVALID-KEY":this._abort("invalid-key",'API KEY "'+this.options.key+'" is invalid');break;case"LEAVE":r.log("Received leave message from",o),this._cleanupPeer(o);break;case"EXPIRE":this.emitError("peer-unavailable","Could not connect to peer "+o);break;case"OFFER":var u=i.connectionId;if(e=this.getConnection(o,u))r.warn("Offer received for existing Connection ID:",u);else{if("media"===i.type)e=new s(o,this,{connectionId:u,_payload:i,metadata:i.metadata}),this._addConnection(o,e),this.emit("call",e);else{if("data"!==i.type)return void r.warn("Received malformed connection type:",i.type);e=new a(o,this,{connectionId:u,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable}),this._addConnection(o,e),this.emit("connection",e)}for(var c=this._getMessages(u),h=0,f=c.length;f>h;h+=1)e.handleMessage(c[h])}break;default:if(!i)return void r.warn("You received a malformed message from "+o+" of type "+n);var p=i.connectionId;e=this.getConnection(o,p),e&&e.pc?e.handleMessage(t):p?this._storeMessage(p,t):r.warn("You received an unrecognized message:",t)}},n.prototype._storeMessage=function(t,e){this._lostMessages[t]||(this._lostMessages[t]=[]),this._lostMessages[t].push(e)},n.prototype._getMessages=function(t){var e=this._lostMessages[t];return e?(delete this._lostMessages[t],e):[]},n.prototype.connect=function(t,e){if(this.disconnected)return r.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");var n=new a(t,this,e);return this._addConnection(t,n),n},n.prototype.call=function(t,e,n){if(this.disconnected)return r.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),void this.emitError("disconnected","Cannot connect to new Peer after disconnecting from server.");if(!e)return void r.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");n=n||{},n._stream=e;var i=new s(t,this,n);return this._addConnection(t,i),i},n.prototype._addConnection=function(t,e){this.connections[t]||(this.connections[t]=[]),this.connections[t].push(e)},n.prototype.getConnection=function(t,e){var n=this.connections[t];if(!n)return null;for(var r=0,i=n.length;i>r;r++)if(n[r].id===e)return n[r];return null},n.prototype._delayedAbort=function(t,e){var n=this;r.setZeroTimeout(function(){n._abort(t,e)})},n.prototype._abort=function(t,e){r.error("Aborting!"),this._lastServerId?this.disconnect():this.destroy(),this.emitError(t,e)},n.prototype.emitError=function(t,e){r.error("Error:",e),"string"==typeof e&&(e=new Error(e)),e.type=t,this.emit("error",e)},n.prototype.destroy=function(){this.destroyed||(this._cleanup(),this.disconnect(),this.destroyed=!0)},n.prototype._cleanup=function(){if(this.connections)for(var t=Object.keys(this.connections),e=0,n=t.length;n>e;e++)this._cleanupPeer(t[e]);this.emit("close")},n.prototype._cleanupPeer=function(t){for(var e=this.connections[t],n=0,r=e.length;r>n;n+=1)e[n].close()},n.prototype.disconnect=function(){var t=this;r.setZeroTimeout(function(){t.disconnected||(t.disconnected=!0,t.open=!1,t.socket&&t.socket.close(),t.emit("disconnected",t.id),t._lastServerId=t.id,t.id=null)})},n.prototype.reconnect=function(){if(this.disconnected&&!this.destroyed)r.log("Attempting reconnection to server with ID "+this._lastServerId),this.disconnected=!1,this._initializeServerConnection(),this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(this.disconnected||this.open)throw new Error("Peer "+this.id+" cannot reconnect because it is not disconnected from the server!");
r.error("In a hurry? We're still trying to make the initial connection!")}},n.prototype.listAllPeers=function(t){t=t||function(){};var e=this,n=new XMLHttpRequest,i=this.options.secure?"https://":"http://",o=i+this.options.host+":"+this.options.port+this.options.path+this.options.key+"/peers",s="?ts="+(new Date).getTime()+Math.random();o+=s,n.open("get",o,!0),n.onerror=function(){e._abort("server-error","Could not get peers from the server."),t([])},n.onreadystatechange=function(){if(4===n.readyState){if(401===n.status){var i="";throw i=e.options.host!==r.CLOUD_HOST?"It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":"You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",t([]),new Error("It doesn't look like you have permission to list peers IDs. "+i)}t(200!==n.status?[]:JSON.parse(n.responseText))}},n.send(null)},e.exports=n},{"./dataconnection":2,"./mediaconnection":4,"./socket":7,"./util":8,eventemitter3:9}],7:[function(t,e){function n(t,e,r,o,s){if(!(this instanceof n))return new n(t,e,r,o,s);i.call(this),this.disconnected=!1,this._queue=[];var a=t?"https://":"http://",u=t?"wss://":"ws://";this._httpUrl=a+e+":"+r+o+s,this._wsUrl=u+e+":"+r+o+"peerjs?key="+s}var r=t("./util"),i=t("eventemitter3");r.inherits(n,i),n.prototype.start=function(t,e){this.id=t,this._httpUrl+="/"+t+"/"+e,this._wsUrl+="&id="+t+"&token="+e,this._startXhrStream(),this._startWebSocket()},n.prototype._startWebSocket=function(){var t=this;this._socket||(this._socket=new WebSocket(this._wsUrl),this._socket.onmessage=function(e){try{var n=JSON.parse(e.data)}catch(i){return void r.log("Invalid server message",e.data)}t.emit("message",n)},this._socket.onclose=function(){r.log("Socket closed."),t.disconnected=!0,t.emit("disconnected")},this._socket.onopen=function(){t._timeout&&(clearTimeout(t._timeout),setTimeout(function(){t._http.abort(),t._http=null},5e3)),t._sendQueuedMessages(),r.log("Socket open")})},n.prototype._startXhrStream=function(t){try{var e=this;this._http=new XMLHttpRequest,this._http._index=1,this._http._streamIndex=t||0,this._http.open("post",this._httpUrl+"/id?i="+this._http._streamIndex,!0),this._http.onerror=function(){clearTimeout(e._timeout),e.emit("disconnected")},this._http.onreadystatechange=function(){2==this.readyState&&this.old?(this.old.abort(),delete this.old):this.readyState>2&&200===this.status&&this.responseText&&e._handleStream(this)},this._http.send(null),this._setHTTPTimeout()}catch(n){r.log("XMLHttpRequest not available; defaulting to WebSockets")}},n.prototype._handleStream=function(t){var e=t.responseText.split("\n");if(t._buffer)for(;t._buffer.length>0;){var n=t._buffer.shift(),i=e[n];try{i=JSON.parse(i)}catch(o){t._buffer.shift(n);break}this.emit("message",i)}var s=e[t._index];if(s)if(t._index+=1,t._index===e.length)t._buffer||(t._buffer=[]),t._buffer.push(t._index-1);else{try{s=JSON.parse(s)}catch(o){return void r.log("Invalid server message",s)}this.emit("message",s)}},n.prototype._setHTTPTimeout=function(){var t=this;this._timeout=setTimeout(function(){var e=t._http;t._wsOpen()?e.abort():(t._startXhrStream(e._streamIndex+1),t._http.old=e)},25e3)},n.prototype._wsOpen=function(){return this._socket&&1==this._socket.readyState},n.prototype._sendQueuedMessages=function(){for(var t=0,e=this._queue.length;e>t;t+=1)this.send(this._queue[t])},n.prototype.send=function(t){if(!this.disconnected){if(!this.id)return void this._queue.push(t);if(!t.type)return void this.emit("error","Invalid message");var e=JSON.stringify(t);if(this._wsOpen())this._socket.send(e);else{var n=new XMLHttpRequest,r=this._httpUrl+"/"+t.type.toLowerCase();n.open("post",r,!0),n.setRequestHeader("Content-Type","application/json"),n.send(e)}}},n.prototype.close=function(){!this.disconnected&&this._wsOpen()&&(this._socket.close(),this.disconnected=!0)},e.exports=n},{"./util":8,eventemitter3:9}],8:[function(t,e){var n={iceServers:[{url:"stun:stun.l.google.com:19302"}]},r=1,i=t("js-binarypack"),o=t("./adapter").RTCPeerConnection,s={noop:function(){},CLOUD_HOST:"0.peerjs.com",CLOUD_PORT:9e3,chunkedBrowsers:{Chrome:1},chunkedMTU:16300,logLevel:0,setLogLevel:function(t){var e=parseInt(t,10);s.logLevel=isNaN(parseInt(t,10))?t?3:0:e,s.log=s.warn=s.error=s.noop,s.logLevel>0&&(s.error=s._printWith("ERROR")),s.logLevel>1&&(s.warn=s._printWith("WARNING")),s.logLevel>2&&(s.log=s._print)},setLogFunction:function(t){t.constructor!==Function?s.warn("The log function you passed in is not a function. Defaulting to regular logs."):s._print=t},_printWith:function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t),s._print.apply(s,e)}},_print:function(){var t=!1,e=Array.prototype.slice.call(arguments);e.unshift("PeerJS: ");for(var n=0,r=e.length;r>n;n++)e[n]instanceof Error&&(e[n]="("+e[n].name+") "+e[n].message,t=!0);t?console.error.apply(console,e):console.log.apply(console,e)},defaultConfig:n,browser:function(){return window.mozRTCPeerConnection?"Firefox":window.webkitRTCPeerConnection?"Chrome":window.RTCPeerConnection?"Supported":"Unsupported"}(),supports:function(){if("undefined"==typeof o)return{};var t,e,r=!0,i=!0,a=!1,u=!1,c=!!window.webkitRTCPeerConnection;try{t=new o(n,{optional:[{RtpDataChannels:!0}]})}catch(h){r=!1,i=!1}if(r)try{e=t.createDataChannel("_PEERJSTEST")}catch(h){r=!1}if(r){try{e.binaryType="blob",a=!0}catch(h){}var f=new o(n,{});try{var p=f.createDataChannel("_PEERJSRELIABLETEST",{});u=p.reliable}catch(h){}f.close()}if(i&&(i=!!t.addStream),!c&&r){var l=new o(n,{optional:[{RtpDataChannels:!0}]});l.onnegotiationneeded=function(){c=!0,s&&s.supports&&(s.supports.onnegotiationneeded=!0)},l.createDataChannel("_PEERJSNEGOTIATIONTEST"),setTimeout(function(){l.close()},1e3)}return t&&t.close(),{audioVideo:i,data:r,binaryBlob:a,binary:u,reliable:u,sctp:u,onnegotiationneeded:c}}(),validateId:function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(t)},validateKey:function(t){return!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.exec(t)},debug:!1,inherits:function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},extend:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},pack:i.pack,unpack:i.unpack,log:function(){if(s.debug){var t=!1,e=Array.prototype.slice.call(arguments);e.unshift("PeerJS: ");for(var n=0,r=e.length;r>n;n++)e[n]instanceof Error&&(e[n]="("+e[n].name+") "+e[n].message,t=!0);t?console.error.apply(console,e):console.log.apply(console,e)}},setZeroTimeout:function(t){function e(e){r.push(e),t.postMessage(i,"*")}function n(e){e.source==t&&e.data==i&&(e.stopPropagation&&e.stopPropagation(),r.length&&r.shift()())}var r=[],i="zero-timeout-message";return t.addEventListener?t.addEventListener("message",n,!0):t.attachEvent&&t.attachEvent("onmessage",n),e}(window),chunk:function(t){for(var e=[],n=t.size,i=index=0,o=Math.ceil(n/s.chunkedMTU);n>i;){var a=Math.min(n,i+s.chunkedMTU),u=t.slice(i,a),c={__peerData:r,n:index,data:u,total:o};e.push(c),i=a,index+=1}return r+=1,e},blobToArrayBuffer:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsArrayBuffer(t)},blobToBinaryString:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsBinaryString(t)},binaryStringToArrayBuffer:function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer},randomToken:function(){return Math.random().toString(36).substr(2)},isSecure:function(){return"https:"===location.protocol}};e.exports=s},{"./adapter":1,"js-binarypack":10}],9:[function(t,e){"use strict";function n(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function r(){}r.prototype._events=void 0,r.prototype.listeners=function(t){if(!this._events||!this._events[t])return[];for(var e=0,n=this._events[t].length,r=[];n>e;e++)r.push(this._events[t][e].fn);return r},r.prototype.emit=function(t,e,n,r,i,o){if(!this._events||!this._events[t])return!1;var s,a,u,c=this._events[t],h=c.length,f=arguments.length,p=c[0];if(1===h){switch(p.once&&this.removeListener(t,p.fn,!0),f){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,e),!0;case 3:return p.fn.call(p.context,e,n),!0;case 4:return p.fn.call(p.context,e,n,r),!0;case 5:return p.fn.call(p.context,e,n,r,i),!0;case 6:return p.fn.call(p.context,e,n,r,i,o),!0}for(a=1,s=new Array(f-1);f>a;a++)s[a-1]=arguments[a];p.fn.apply(p.context,s)}else for(a=0;h>a;a++)switch(c[a].once&&this.removeListener(t,c[a].fn,!0),f){case 1:c[a].fn.call(c[a].context);break;case 2:c[a].fn.call(c[a].context,e);break;case 3:c[a].fn.call(c[a].context,e,n);break;default:if(!s)for(u=1,s=new Array(f-1);f>u;u++)s[u-1]=arguments[u];c[a].fn.apply(c[a].context,s)}return!0},r.prototype.on=function(t,e,r){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),this._events[t].push(new n(e,r||this)),this},r.prototype.once=function(t,e,r){return this._events||(this._events={}),this._events[t]||(this._events[t]=[]),this._events[t].push(new n(e,r||this,!0)),this},r.prototype.removeListener=function(t,e,n){if(!this._events||!this._events[t])return this;var r=this._events[t],i=[];if(e)for(var o=0,s=r.length;s>o;o++)r[o].fn!==e&&r[o].once!==n&&i.push(r[o]);return this._events[t]=i.length?i:null,this},r.prototype.removeAllListeners=function(t){return this._events?(t?this._events[t]=null:this._events={},this):this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.EventEmitter=r,r.EventEmitter2=r,r.EventEmitter3=r,"object"==typeof e&&e.exports&&(e.exports=r)},{}],10:[function(t,e){function n(t){this.index=0,this.dataBuffer=t,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function r(){this.bufferBuilder=new s}function i(t){var e=t.charCodeAt(0);return 2047>=e?"00":65535>=e?"000":2097151>=e?"0000":67108863>=e?"00000":"000000"}function o(t){return t.length>600?new Blob([t]).size:t.replace(/[^\u0000-\u007F]/g,i).length}var s=t("./bufferbuilder").BufferBuilder,a=t("./bufferbuilder").binaryFeatures,u={unpack:function(t){var e=new n(t);return e.unpack()},pack:function(t){var e=new r;e.pack(t);var n=e.getBuffer();return n}};e.exports=u,n.prototype.unpack=function(){var t=this.unpack_uint8();if(128>t){var e=t;return e}if(32>(224^t)){var n=(224^t)-32;return n}var r;if((r=160^t)<=15)return this.unpack_raw(r);if((r=176^t)<=15)return this.unpack_string(r);if((r=144^t)<=15)return this.unpack_array(r);if((r=128^t)<=15)return this.unpack_map(r);switch(t){case 192:return null;case 193:return void 0;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return void 0;case 213:return void 0;case 214:return void 0;case 215:return void 0;case 216:return r=this.unpack_uint16(),this.unpack_string(r);case 217:return r=this.unpack_uint32(),this.unpack_string(r);case 218:return r=this.unpack_uint16(),this.unpack_raw(r);case 219:return r=this.unpack_uint32(),this.unpack_raw(r);case 220:return r=this.unpack_uint16(),this.unpack_array(r);case 221:return r=this.unpack_uint32(),this.unpack_array(r);case 222:return r=this.unpack_uint16(),this.unpack_map(r);case 223:return r=this.unpack_uint32(),this.unpack_map(r)}},n.prototype.unpack_uint8=function(){var t=255&this.dataView[this.index];return this.index++,t},n.prototype.unpack_uint16=function(){var t=this.read(2),e=256*(255&t[0])+(255&t[1]);return this.index+=2,e},n.prototype.unpack_uint32=function(){var t=this.read(4),e=256*(256*(256*t[0]+t[1])+t[2])+t[3];return this.index+=4,e},n.prototype.unpack_uint64=function(){var t=this.read(8),e=256*(256*(256*(256*(256*(256*(256*t[0]+t[1])+t[2])+t[3])+t[4])+t[5])+t[6])+t[7];return this.index+=8,e},n.prototype.unpack_int8=function(){var t=this.unpack_uint8();return 128>t?t:t-256},n.prototype.unpack_int16=function(){var t=this.unpack_uint16();return 32768>t?t:t-65536},n.prototype.unpack_int32=function(){var t=this.unpack_uint32();return t<Math.pow(2,31)?t:t-Math.pow(2,32)},n.prototype.unpack_int64=function(){var t=this.unpack_uint64();return t<Math.pow(2,63)?t:t-Math.pow(2,64)},n.prototype.unpack_raw=function(t){if(this.length<this.index+t)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+t+" "+this.length);var e=this.dataBuffer.slice(this.index,this.index+t);return this.index+=t,e},n.prototype.unpack_string=function(t){for(var e,n,r=this.read(t),i=0,o="";t>i;)e=r[i],128>e?(o+=String.fromCharCode(e),i++):32>(192^e)?(n=(192^e)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&e)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=t,o},n.prototype.unpack_array=function(t){for(var e=new Array(t),n=0;t>n;n++)e[n]=this.unpack();return e},n.prototype.unpack_map=function(t){for(var e={},n=0;t>n;n++){var r=this.unpack(),i=this.unpack();e[r]=i}return e},n.prototype.unpack_float=function(){var t=this.unpack_uint32(),e=t>>31,n=(t>>23&255)-127,r=8388607&t|8388608;return(0==e?1:-1)*r*Math.pow(2,n-23)},n.prototype.unpack_double=function(){var t=this.unpack_uint32(),e=this.unpack_uint32(),n=t>>31,r=(t>>20&2047)-1023,i=1048575&t|1048576,o=i*Math.pow(2,r-20)+e*Math.pow(2,r-52);return(0==n?1:-1)*o},n.prototype.read=function(t){var e=this.index;if(e+t<=this.length)return this.dataView.subarray(e,e+t);throw new Error("BinaryPackFailure: read index out of range")},r.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},r.prototype.pack=function(t){var e=typeof t;if("string"==e)this.pack_string(t);else if("number"==e)Math.floor(t)===t?this.pack_integer(t):this.pack_double(t);else if("boolean"==e)t===!0?this.bufferBuilder.append(195):t===!1&&this.bufferBuilder.append(194);else if("undefined"==e)this.bufferBuilder.append(192);else{if("object"!=e)throw new Error('Type "'+e+'" not yet supported');if(null===t)this.bufferBuilder.append(192);else{var n=t.constructor;if(n==Array)this.pack_array(t);else if(n==Blob||n==File)this.pack_bin(t);else if(n==ArrayBuffer)this.pack_bin(a.useArrayBufferView?new Uint8Array(t):t);else if("BYTES_PER_ELEMENT"in t)this.pack_bin(a.useArrayBufferView?new Uint8Array(t.buffer):t.buffer);else if(n==Object)this.pack_object(t);else if(n==Date)this.pack_string(t.toString());else{if("function"!=typeof t.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(t.toBinaryPack())}}}this.bufferBuilder.flush()},r.prototype.pack_bin=function(t){var e=t.length||t.byteLength||t.size;if(15>=e)this.pack_uint8(160+e);else if(65535>=e)this.bufferBuilder.append(218),this.pack_uint16(e);else{if(!(4294967295>=e))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(e)}this.bufferBuilder.append(t)},r.prototype.pack_string=function(t){var e=o(t);if(15>=e)this.pack_uint8(176+e);else if(65535>=e)this.bufferBuilder.append(216),this.pack_uint16(e);else{if(!(4294967295>=e))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(e)}this.bufferBuilder.append(t)},r.prototype.pack_array=function(t){var e=t.length;if(15>=e)this.pack_uint8(144+e);else if(65535>=e)this.bufferBuilder.append(220),this.pack_uint16(e);else{if(!(4294967295>=e))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(e)}for(var n=0;e>n;n++)this.pack(t[n])},r.prototype.pack_integer=function(t){if(t>=-32&&127>=t)this.bufferBuilder.append(255&t);else if(t>=0&&255>=t)this.bufferBuilder.append(204),this.pack_uint8(t);else if(t>=-128&&127>=t)this.bufferBuilder.append(208),this.pack_int8(t);else if(t>=0&&65535>=t)this.bufferBuilder.append(205),this.pack_uint16(t);else if(t>=-32768&&32767>=t)this.bufferBuilder.append(209),this.pack_int16(t);else if(t>=0&&4294967295>=t)this.bufferBuilder.append(206),this.pack_uint32(t);else if(t>=-2147483648&&2147483647>=t)this.bufferBuilder.append(210),this.pack_int32(t);else if(t>=-0x8000000000000000&&0x8000000000000000>=t)this.bufferBuilder.append(211),this.pack_int64(t);else{if(!(t>=0&&0x10000000000000000>=t))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(t)}},r.prototype.pack_double=function(t){var e=0;0>t&&(e=1,t=-t);var n=Math.floor(Math.log(t)/Math.LN2),r=t/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),s=e<<31|n+1023<<20|i/o&1048575,a=i%o;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},r.prototype.pack_object=function(t){var e=Object.keys(t),n=e.length;if(15>=n)this.pack_uint8(128+n);else if(65535>=n)this.bufferBuilder.append(222),this.pack_uint16(n);else{if(!(4294967295>=n))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(n)}for(var r in t)t.hasOwnProperty(r)&&(this.pack(r),this.pack(t[r]))},r.prototype.pack_uint8=function(t){this.bufferBuilder.append(t)},r.prototype.pack_uint16=function(t){this.bufferBuilder.append(t>>8),this.bufferBuilder.append(255&t)},r.prototype.pack_uint32=function(t){var e=4294967295&t;this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},r.prototype.pack_uint64=function(t){var e=t/Math.pow(2,32),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},r.prototype.pack_int8=function(t){this.bufferBuilder.append(255&t)},r.prototype.pack_int16=function(t){this.bufferBuilder.append((65280&t)>>8),this.bufferBuilder.append(255&t)},r.prototype.pack_int32=function(t){this.bufferBuilder.append(t>>>24&255),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},r.prototype.pack_int64=function(t){var e=Math.floor(t/Math.pow(2,32)),n=t%Math.pow(2,32);this.bufferBuilder.append((4278190080&e)>>>24),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},{"./bufferbuilder":11}],11:[function(t,e){function n(){this._pieces=[],this._parts=[]}var r={};r.useBlobBuilder=function(){try{return new Blob([]),!1}catch(t){return!0}}(),r.useArrayBufferView=!r.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(t){return!0}}(),e.exports.binaryFeatures=r;var i=e.exports.BlobBuilder;"undefined"!=typeof window&&(i=e.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),n.prototype.append=function(t){"number"==typeof t?this._pieces.push(t):(this.flush(),this._parts.push(t))},n.prototype.flush=function(){if(this._pieces.length>0){var t=new Uint8Array(this._pieces);r.useArrayBufferView||(t=t.buffer),this._parts.push(t),this._pieces=[]}},n.prototype.getBuffer=function(){if(this.flush(),r.useBlobBuilder){for(var t=new i,e=0,n=this._parts.length;n>e;e++)t.append(this._parts[e]);return t.getBlob()}return new Blob(this._parts)},e.exports.BufferBuilder=n},{}],12:[function(t,e){function n(t,e){return this instanceof n?(this._dc=t,r.debug=e,this._outgoing={},this._incoming={},this._received={},this._window=1e3,this._mtu=500,this._interval=0,this._count=0,this._queue=[],void this._setupDC()):new n(t)}var r=t("./util");n.prototype.send=function(t){var e=r.pack(t);return e.size<this._mtu?void this._handleSend(["no",e]):(this._outgoing[this._count]={ack:0,chunks:this._chunk(e)},r.debug&&(this._outgoing[this._count].timer=new Date),this._sendWindowedChunks(this._count),void(this._count+=1))},n.prototype._setupInterval=function(){var t=this;this._timeout=setInterval(function(){var e=t._queue.shift();if(e._multiple)for(var n=0,r=e.length;r>n;n+=1)t._intervalSend(e[n]);else t._intervalSend(e)},this._interval)},n.prototype._intervalSend=function(t){var e=this;t=r.pack(t),r.blobToBinaryString(t,function(t){e._dc.send(t)}),0===e._queue.length&&(clearTimeout(e._timeout),e._timeout=null)},n.prototype._processAcks=function(){for(var t in this._outgoing)this._outgoing.hasOwnProperty(t)&&this._sendWindowedChunks(t)},n.prototype._handleSend=function(t){for(var e=!0,n=0,r=this._queue.length;r>n;n+=1){var i=this._queue[n];i===t?e=!1:i._multiple&&-1!==i.indexOf(t)&&(e=!1)}e&&(this._queue.push(t),this._timeout||this._setupInterval())},n.prototype._setupDC=function(){var t=this;this._dc.onmessage=function(e){var n=e.data,i=n.constructor;if(i===String){var o=r.binaryStringToArrayBuffer(n);n=r.unpack(o),t._handleMessage(n)}}},n.prototype._handleMessage=function(t){var e,n=t[1],i=this._incoming[n],o=this._outgoing[n];switch(t[0]){case"no":var s=n;s&&this.onmessage(r.unpack(s));break;case"end":if(e=i,this._received[n]=t[2],!e)break;this._ack(n);break;case"ack":if(e=o){var a=t[2];e.ack=Math.max(a,e.ack),e.ack>=e.chunks.length?(r.log("Time: ",new Date-e.timer),delete this._outgoing[n]):this._processAcks()}break;case"chunk":if(e=i,!e){var u=this._received[n];if(u===!0)break;e={ack:["ack",n,0],chunks:[]},this._incoming[n]=e}var c=t[2],h=t[3];e.chunks[c]=new Uint8Array(h),c===e.ack[2]&&this._calculateNextAck(n),this._ack(n);break;default:this._handleSend(t)}},n.prototype._chunk=function(t){for(var e=[],n=t.size,i=0;n>i;){var o=Math.min(n,i+this._mtu),s=t.slice(i,o),a={payload:s};e.push(a),i=o}return r.log("Created",e.length,"chunks."),e},n.prototype._ack=function(t){var e=this._incoming[t].ack;this._received[t]===e[2]&&(this._complete(t),this._received[t]=!0),this._handleSend(e)},n.prototype._calculateNextAck=function(t){for(var e=this._incoming[t],n=e.chunks,r=0,i=n.length;i>r;r+=1)if(void 0===n[r])return void(e.ack[2]=r);e.ack[2]=n.length},n.prototype._sendWindowedChunks=function(t){r.log("sendWindowedChunks for: ",t);for(var e=this._outgoing[t],n=e.chunks,i=[],o=Math.min(e.ack+this._window,n.length),s=e.ack;o>s;s+=1)n[s].sent&&s!==e.ack||(n[s].sent=!0,i.push(["chunk",t,s,n[s].payload]));e.ack+this._window>=n.length&&i.push(["end",t,n.length]),i._multiple=!0,this._handleSend(i)},n.prototype._complete=function(t){r.log("Completed called for",t);var e=this,n=this._incoming[t].chunks,i=new Blob(n);r.blobToArrayBuffer(i,function(t){e.onmessage(r.unpack(t))}),delete this._incoming[t]},n.higherBandwidthSDP=function(t){var e=navigator.appVersion.match(/Chrome\/(.*?) /);if(e&&(e=parseInt(e[1].split(".").shift()),31>e)){var n=t.split("b=AS:30"),r="b=AS:102400";if(n.length>1)return n[0]+r+n[1]}return t},n.prototype.onmessage=function(){},e.exports.Reliable=n},{"./util":13}],13:[function(t,e){var n=t("js-binarypack"),r={debug:!1,inherits:function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})},extend:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},pack:n.pack,unpack:n.unpack,log:function(){if(r.debug){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.unshift("Reliable: "),console.log.apply(console,t)}},setZeroTimeout:function(t){function e(e){r.push(e),t.postMessage(i,"*")}function n(e){e.source==t&&e.data==i&&(e.stopPropagation&&e.stopPropagation(),r.length&&r.shift()())}var r=[],i="zero-timeout-message";return t.addEventListener?t.addEventListener("message",n,!0):t.attachEvent&&t.attachEvent("onmessage",n),e}(this),blobToArrayBuffer:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsArrayBuffer(t)},blobToBinaryString:function(t,e){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.readAsBinaryString(t)},binaryStringToArrayBuffer:function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=255&t.charCodeAt(n);return e.buffer},randomToken:function(){return Math.random().toString(36).substr(2)}};e.exports=r},{"js-binarypack":10}]},{},[3]),RC4.getStringBytes=function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n),i=[];do i.push(255&r),r>>=8;while(r>0);e=e.concat(i.reverse())}return e},RC4.prototype._swap=function(t,e){var n=this.s[t];this.s[t]=this.s[e],this.s[e]=n},RC4.prototype.mix=function(t){for(var e=RC4.getStringBytes(t),n=0,r=0;r<this.s.length;r++)n+=this.s[r]+e[r%e.length],n%=256,this._swap(r,n)},RC4.prototype.next=function(){return this.i=(this.i+1)%256,this.j=(this.j+this.s[this.i])%256,this._swap(this.i,this.j),this.s[(this.s[this.i]+this.s[this.j])%256]},RNG.prototype.nextByte=function(){return this._state.next()},RNG.prototype.uniform=function(){for(var t=7,e=0,n=0;t>n;n++)e*=256,e+=this.nextByte();return e/(Math.pow(2,8*t)-1)},RNG.prototype.random=function(t,e){return null==t?this.uniform():(null==e&&(e=t,t=0),t+Math.floor(this.uniform()*(e-t)))},RNG.prototype.normal=function(){if(null!==this._normal){var t=this._normal;return this._normal=null,t}var e=this.uniform()||Math.pow(2,-53),n=this.uniform();return this._normal=Math.sqrt(-2*Math.log(e))*Math.sin(2*Math.PI*n),Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*n)},RNG.prototype.exponential=function(){return-Math.log(this.uniform()||Math.pow(2,-53))},RNG.prototype.poisson=function(t){var e=Math.exp(-(t||1)),n=0,r=1;do n++,r*=this.uniform();while(r>e);return n-1},RNG.prototype.gamma=function(t){var e=(1>t?1+t:t)-1/3,n=1/Math.sqrt(9*e);do{do var r=this.normal(),i=Math.pow(n*r+1,3);while(0>=i);var o=this.uniform(),s=Math.pow(r,2)}while(o>=1-.0331*s*s&&Math.log(o)>=.5*s+e*(1-i+Math.log(i)));return 1>t?e*i*Math.exp(this.exponential()/-t):e*i},RNG.roller=function(t,e){var n=t.split(/(\d+)?d(\d+)([+-]\d+)?/).slice(1),r=parseFloat(n[0])||1,i=parseFloat(n[1]),o=parseFloat(n[2])||0;return e=e||new RNG,function(){for(var t=r+o,n=0;r>n;n++)t+=e.random(i);return t}},RNG.$=new RNG,function(){var t={},e=null,n=!0,r=!1;try{"undefined"!=typeof AudioContext?e=new AudioContext:"undefined"!=typeof webkitAudioContext?e=new webkitAudioContext:n=!1}catch(i){n=!1}if(!n)if("undefined"!=typeof Audio)try{new Audio}catch(i){r=!0}else r=!0;if(n){var o="undefined"==typeof e.createGain?e.createGainNode():e.createGain();o.gain.value=1,o.connect(e.destination)}var s=function(t){this._volume=1,this._muted=!1,this.usingWebAudio=n,this.ctx=e,this.noAudio=r,this._howls=[],this._codecs=t,this.iOSAutoEnable=!0};s.prototype={volume:function(t){var e=this;if(t=parseFloat(t),t>=0&&1>=t){e._volume=t,n&&(o.gain.value=t);for(var r in e._howls)if(e._howls.hasOwnProperty(r)&&e._howls[r]._webAudio===!1)for(var i=0;i<e._howls[r]._audioNode.length;i++)e._howls[r]._audioNode[i].volume=e._howls[r]._volume*e._volume;return e}return n?o.gain.value:e._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(t){var e=this;e._muted=t,n&&(o.gain.value=t?0:e._volume);for(var r in e._howls)if(e._howls.hasOwnProperty(r)&&e._howls[r]._webAudio===!1)for(var i=0;i<e._howls[r]._audioNode.length;i++)e._howls[r]._audioNode[i].muted=t},codecs:function(t){return this._codecs[t]},_enableiOSAudio:function(){var t=this;if(!e||!t._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){t._iOSEnabled=!1;var n=function(){var r=e.createBuffer(1,1,22050),i=e.createBufferSource();i.buffer=r,i.connect(e.destination),"undefined"==typeof i.start?i.noteOn(0):i.start(0),setTimeout(function(){(i.playbackState===i.PLAYING_STATE||i.playbackState===i.FINISHED_STATE)&&(t._iOSEnabled=!0,t.iOSAutoEnable=!1,window.removeEventListener("touchend",n,!1))},0)};return window.addEventListener("touchend",n,!1),t}}};var a=null,u={};r||(a=new Audio,u={mp3:!!a.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!a.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")});var c=new s(u),h=function(t){var r=this;r._autoplay=t.autoplay||!1,r._buffer=t.buffer||!1,r._duration=t.duration||0,r._format=t.format||null,r._loop=t.loop||!1,r._loaded=!1,r._sprite=t.sprite||{},r._src=t.src||"",r._pos3d=t.pos3d||[0,0,-.5],r._volume=void 0!==t.volume?t.volume:1,r._urls=t.urls||[],r._rate=t.rate||1,r._model=t.model||null,r._onload=[t.onload||function(){}],r._onloaderror=[t.onloaderror||function(){}],r._onend=[t.onend||function(){}],r._onpause=[t.onpause||function(){}],r._onplay=[t.onplay||function(){}],r._onendTimer=[],r._webAudio=n&&!r._buffer,r._audioNode=[],r._webAudio&&r._setupAudioNode(),"undefined"!=typeof e&&e&&c.iOSAutoEnable&&c._enableiOSAudio(),c._howls.push(r),r.load()};if(h.prototype={load:function(){var t=this,e=null;if(r)return void t.on("loaderror");for(var n=0;n<t._urls.length;n++){var i,o;if(t._format)i=t._format;else{if(o=t._urls[n],i=/^data:audio\/([^;,]+);/i.exec(o),i||(i=/\.([^.]+)$/.exec(o.split("?",1)[0])),!i)return void t.on("loaderror");i=i[1].toLowerCase()}if(u[i]){e=t._urls[n];break}}if(!e)return void t.on("loaderror");if(t._src=e,t._webAudio)f(t,e);else{var a=new Audio;a.addEventListener("error",function(){a.error&&4===a.error.code&&(s.noAudio=!0),t.on("loaderror",{type:a.error?a.error.code:0})},!1),t._audioNode.push(a),a.src=e,a._pos=0,a.preload="auto",a.volume=c._muted?0:t._volume*c.volume();var h=function(){t._duration=Math.ceil(10*a.duration)/10,0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]}),t._loaded||(t._loaded=!0,t.on("load")),t._autoplay&&t.play(),a.removeEventListener("canplaythrough",h,!1)};a.addEventListener("canplaythrough",h,!1),a.load()}return t},urls:function(t){var e=this;return t?(e.stop(),e._urls="string"==typeof t?[t]:t,e._loaded=!1,e.load(),e):e._urls},play:function(t,n){var r=this;return"function"==typeof t&&(n=t),t&&"function"!=typeof t||(t="_default"),r._loaded?r._sprite[t]?(r._inactiveNode(function(i){i._sprite=t;var o=i._pos>0?i._pos:r._sprite[t][0]/1e3,s=0;r._webAudio?(s=r._sprite[t][1]/1e3-i._pos,i._pos>0&&(o=r._sprite[t][0]/1e3+o)):s=r._sprite[t][1]/1e3-(o-r._sprite[t][0]/1e3);var a,u=!(!r._loop&&!r._sprite[t][2]),h="string"==typeof n?n:Math.round(Date.now()*Math.random())+"";if(function(){var e={id:h,sprite:t,loop:u};a=setTimeout(function(){!r._webAudio&&u&&r.stop(e.id).play(t,e.id),r._webAudio&&!u&&(r._nodeById(e.id).paused=!0,r._nodeById(e.id)._pos=0,r._clearEndTimer(e.id)),r._webAudio||u||r.stop(e.id),r.on("end",h)},1e3*s),r._onendTimer.push({timer:a,id:e.id})}(),r._webAudio){var f=r._sprite[t][0]/1e3,p=r._sprite[t][1]/1e3;i.id=h,i.paused=!1,d(r,[u,f,p],h),r._playStart=e.currentTime,i.gain.value=r._volume,"undefined"==typeof i.bufferSource.start?u?i.bufferSource.noteGrainOn(0,o,86400):i.bufferSource.noteGrainOn(0,o,s):u?i.bufferSource.start(0,o,86400):i.bufferSource.start(0,o,s)}else{if(4!==i.readyState&&(i.readyState||!navigator.isCocoonJS))return r._clearEndTimer(h),function(){var e=r,o=t,s=n,a=i,u=function(){e.play(o,s),a.removeEventListener("canplaythrough",u,!1)};a.addEventListener("canplaythrough",u,!1)}(),r;i.readyState=4,i.id=h,i.currentTime=o,i.muted=c._muted||i.muted,i.volume=r._volume*c.volume(),setTimeout(function(){i.play()},0)}return r.on("play"),"function"==typeof n&&n(h),r}),r):("function"==typeof n&&n(),r):(r.on("load",function(){r.play(t,n)}),r)},pause:function(t){var e=this;if(!e._loaded)return e.on("play",function(){
e.pause(t)}),e;e._clearEndTimer(t);var n=t?e._nodeById(t):e._activeNode();if(n)if(n._pos=e.pos(null,t),e._webAudio){if(!n.bufferSource||n.paused)return e;n.paused=!0,"undefined"==typeof n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else n.pause();return e.on("pause"),e},stop:function(t){var e=this;if(!e._loaded)return e.on("play",function(){e.stop(t)}),e;e._clearEndTimer(t);var n=t?e._nodeById(t):e._activeNode();if(n)if(n._pos=0,e._webAudio){if(!n.bufferSource||n.paused)return e;n.paused=!0,"undefined"==typeof n.bufferSource.stop?n.bufferSource.noteOff(0):n.bufferSource.stop(0)}else isNaN(n.duration)||(n.pause(),n.currentTime=0);return e},mute:function(t){var e=this;if(!e._loaded)return e.on("play",function(){e.mute(t)}),e;var n=t?e._nodeById(t):e._activeNode();return n&&(e._webAudio?n.gain.value=0:n.muted=!0),e},unmute:function(t){var e=this;if(!e._loaded)return e.on("play",function(){e.unmute(t)}),e;var n=t?e._nodeById(t):e._activeNode();return n&&(e._webAudio?n.gain.value=e._volume:n.muted=!1),e},volume:function(t,e){var n=this;if(t=parseFloat(t),t>=0&&1>=t){if(n._volume=t,!n._loaded)return n.on("play",function(){n.volume(t,e)}),n;var r=e?n._nodeById(e):n._activeNode();return r&&(n._webAudio?r.gain.value=t:r.volume=t*c.volume()),n}return n._volume},loop:function(t){var e=this;return"boolean"==typeof t?(e._loop=t,e):e._loop},sprite:function(t){var e=this;return"object"==typeof t?(e._sprite=t,e):e._sprite},pos:function(t,n){var r=this;if(!r._loaded)return r.on("load",function(){r.pos(t)}),"number"==typeof t?r:r._pos||0;t=parseFloat(t);var i=n?r._nodeById(n):r._activeNode();if(i)return t>=0?(r.pause(n),i._pos=t,r.play(i._sprite,n),r):r._webAudio?i._pos+(e.currentTime-r._playStart):i.currentTime;if(t>=0)return r;for(var o=0;o<r._audioNode.length;o++)if(r._audioNode[o].paused&&4===r._audioNode[o].readyState)return r._webAudio?r._audioNode[o]._pos:r._audioNode[o].currentTime},pos3d:function(t,e,n,r){var i=this;if(e="undefined"!=typeof e&&e?e:0,n="undefined"!=typeof n&&n?n:-.5,!i._loaded)return i.on("play",function(){i.pos3d(t,e,n,r)}),i;if(!(t>=0||0>t))return i._pos3d;if(i._webAudio){var o=r?i._nodeById(r):i._activeNode();o&&(i._pos3d=[t,e,n],o.panner.setPosition(t,e,n),o.panner.panningModel=i._model||"HRTF")}return i},fade:function(t,e,n,r,i){var o=this,s=Math.abs(t-e),a=t>e?"down":"up",u=s/.01,c=n/u;if(!o._loaded)return o.on("load",function(){o.fade(t,e,n,r,i)}),o;o.volume(t,i);for(var h=1;u>=h;h++)!function(){var t=o._volume+("up"===a?.01:-.01)*h,n=Math.round(1e3*t)/1e3,s=e;setTimeout(function(){o.volume(n,i),n===s&&r&&r()},c*h)}()},fadeIn:function(t,e,n){return this.volume(0).play().fade(0,t,e,n)},fadeOut:function(t,e,n,r){var i=this;return i.fade(i._volume,t,e,function(){n&&n(),i.pause(r),i.on("end")},r)},_nodeById:function(t){for(var e=this,n=e._audioNode[0],r=0;r<e._audioNode.length;r++)if(e._audioNode[r].id===t){n=e._audioNode[r];break}return n},_activeNode:function(){for(var t=this,e=null,n=0;n<t._audioNode.length;n++)if(!t._audioNode[n].paused){e=t._audioNode[n];break}return t._drainPool(),e},_inactiveNode:function(t){for(var e=this,n=null,r=0;r<e._audioNode.length;r++)if(e._audioNode[r].paused&&4===e._audioNode[r].readyState){t(e._audioNode[r]),n=!0;break}if(e._drainPool(),!n){var i;if(e._webAudio)i=e._setupAudioNode(),t(i);else{e.load(),i=e._audioNode[e._audioNode.length-1];var o=navigator.isCocoonJS?"canplaythrough":"loadedmetadata",s=function(){i.removeEventListener(o,s,!1),t(i)};i.addEventListener(o,s,!1)}}},_drainPool:function(){var t,e=this,n=0;for(t=0;t<e._audioNode.length;t++)e._audioNode[t].paused&&n++;for(t=e._audioNode.length-1;t>=0&&!(5>=n);t--)e._audioNode[t].paused&&(e._webAudio&&e._audioNode[t].disconnect(0),n--,e._audioNode.splice(t,1))},_clearEndTimer:function(t){for(var e=this,n=0,r=0;r<e._onendTimer.length;r++)if(e._onendTimer[r].id===t){n=r;break}var i=e._onendTimer[n];i&&(clearTimeout(i.timer),e._onendTimer.splice(n,1))},_setupAudioNode:function(){var t=this,n=t._audioNode,r=t._audioNode.length;return n[r]="undefined"==typeof e.createGain?e.createGainNode():e.createGain(),n[r].gain.value=t._volume,n[r].paused=!0,n[r]._pos=0,n[r].readyState=4,n[r].connect(o),n[r].panner=e.createPanner(),n[r].panner.panningModel=t._model||"equalpower",n[r].panner.setPosition(t._pos3d[0],t._pos3d[1],t._pos3d[2]),n[r].panner.connect(n[r]),n[r]},on:function(t,e){var n=this,r=n["_on"+t];if("function"==typeof e)r.push(e);else for(var i=0;i<r.length;i++)e?r[i].call(n,e):r[i].call(n);return n},off:function(t,e){var n=this,r=n["_on"+t],i=e?e.toString():null;if(i){for(var o=0;o<r.length;o++)if(i===r[o].toString()){r.splice(o,1);break}}else n["_on"+t]=[];return n},unload:function(){for(var e=this,n=e._audioNode,r=0;r<e._audioNode.length;r++)n[r].paused||(e.stop(n[r].id),e.on("end",n[r].id)),e._webAudio?n[r].disconnect(0):n[r].src="";for(r=0;r<e._onendTimer.length;r++)clearTimeout(e._onendTimer[r].timer);var i=c._howls.indexOf(e);null!==i&&i>=0&&c._howls.splice(i,1),delete t[e._src],e=null}},n)var f=function(e,n){if(n in t)return e._duration=t[n].duration,void l(e);if(/^data:[^;]+;base64,/.test(n)){for(var r=atob(n.split(",")[1]),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);p(i.buffer,e,n)}else{var s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType="arraybuffer",s.onload=function(){p(s.response,e,n)},s.onerror=function(){e._webAudio&&(e._buffer=!0,e._webAudio=!1,e._audioNode=[],delete e._gainNode,delete t[n],e.load())};try{s.send()}catch(a){s.onerror()}}},p=function(n,r,i){e.decodeAudioData(n,function(e){e&&(t[i]=e,l(r,e))},function(t){r.on("loaderror")})},l=function(t,e){t._duration=e?e.duration:t._duration,0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]}),t._loaded||(t._loaded=!0,t.on("load")),t._autoplay&&t.play()},d=function(n,r,i){var o=n._nodeById(i);o.bufferSource=e.createBufferSource(),o.bufferSource.buffer=t[n._src],o.bufferSource.connect(o.panner),o.bufferSource.loop=r[0],r[0]&&(o.bufferSource.loopStart=r[1],o.bufferSource.loopEnd=r[1]+r[2]),o.bufferSource.playbackRate.value=n._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:c,Howl:h}}),"undefined"!=typeof exports&&(exports.Howler=c,exports.Howl=h),"undefined"!=typeof window&&(window.Howler=c,window.Howl=h)}(),!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Immutable=e()}(this,function(){"use strict";function t(t,e){e&&(t.prototype=Object.create(e.prototype)),t.prototype.constructor=t}function e(t){return t.value=!1,t}function n(t){t&&(t.value=!0)}function r(){}function i(t,e){e=e||0;for(var n=Math.max(0,t.length-e),r=Array(n),i=0;n>i;i++)r[i]=t[i+e];return r}function o(t){return void 0===t.size&&(t.size=t.__iterate(a)),t.size}function s(t,e){if("number"!=typeof e){var n=+e;if(""+n!==e)return NaN;e=n}return 0>e?o(t)+e:e}function a(){return!0}function u(t,e,n){return(0===t||void 0!==n&&-n>=t)&&(void 0===e||void 0!==n&&e>=n)}function c(t,e){return f(t,e,0)}function h(t,e){return f(t,e,e)}function f(t,e,n){return void 0===t?n:0>t?Math.max(0,e+t):void 0===e?t:Math.min(e,t)}function p(t){return v(t)?t:M(t)}function l(t){return y(t)?t:B(t)}function d(t){return m(t)?t:T(t)}function _(t){return v(t)&&!g(t)?t:D(t)}function v(t){return!(!t||!t[_n])}function y(t){return!(!t||!t[vn])}function m(t){return!(!t||!t[yn])}function g(t){return y(t)||m(t)}function w(t){return!(!t||!t[mn])}function b(t){this.next=t}function k(t,e,n,r){var i=0===t?e:1===t?n:[e,n];return r?r.value=i:r={value:i,done:!1},r}function S(){return{value:void 0,done:!0}}function I(t){return!!E(t)}function z(t){return t&&"function"==typeof t.next}function x(t){var e=E(t);return e&&e.call(t)}function E(t){var e=t&&(kn&&t[kn]||t[Sn]);return"function"==typeof e?e:void 0}function A(t){return t&&"number"==typeof t.length}function M(t){return null===t||void 0===t?N():v(t)?t.toSeq():U(t)}function B(t){return null===t||void 0===t?N().toKeyedSeq():v(t)?y(t)?t.toSeq():t.fromEntrySeq():L(t)}function T(t){return null===t||void 0===t?N():v(t)?y(t)?t.entrySeq():t.toIndexedSeq():j(t)}function D(t){return(null===t||void 0===t?N():v(t)?y(t)?t.entrySeq():t:j(t)).toSetSeq()}function C(t){this._array=t,this.size=t.length}function O(t){var e=Object.keys(t);this._object=t,this._keys=e,this.size=e.length}function q(t){this._iterable=t,this.size=t.length||t.size}function R(t){this._iterator=t,this._iteratorCache=[]}function P(t){return!(!t||!t[zn])}function N(){return xn||(xn=new C([]))}function L(t){var e=Array.isArray(t)?new C(t).fromEntrySeq():z(t)?new R(t).fromEntrySeq():I(t)?new q(t).fromEntrySeq():"object"==typeof t?new O(t):void 0;if(!e)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+t);return e}function j(t){var e=K(t);if(!e)throw new TypeError("Expected Array or iterable object of values: "+t);return e}function U(t){var e=K(t)||"object"==typeof t&&new O(t);if(!e)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+t);return e}function K(t){return A(t)?new C(t):z(t)?new R(t):I(t)?new q(t):void 0}function W(t,e,n,r){var i=t._cache;if(i){for(var o=i.length-1,s=0;o>=s;s++){var a=i[n?o-s:s];if(e(a[1],r?a[0]:s,t)===!1)return s+1}return s}return t.__iterateUncached(e,n)}function F(t,e,n,r){var i=t._cache;if(i){var o=i.length-1,s=0;return new b(function(){var t=i[n?o-s:s];return s++>o?S():k(e,r?t[0]:s-1,t[1])})}return t.__iteratorUncached(e,n)}function H(){throw TypeError("Abstract")}function J(){}function G(){}function V(){}function Y(t,e){if(t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1;if("function"==typeof t.valueOf&&"function"==typeof e.valueOf){if(t=t.valueOf(),e=e.valueOf(),t===e||t!==t&&e!==e)return!0;if(!t||!e)return!1}return"function"==typeof t.equals&&"function"==typeof e.equals&&t.equals(e)?!0:!1}function $(t,e){return e?X(e,t,"",{"":t}):Z(t)}function X(t,e,n,r){return Array.isArray(e)?t.call(r,n,T(e).map(function(n,r){return X(t,n,r,e)})):Q(e)?t.call(r,n,B(e).map(function(n,r){return X(t,n,r,e)})):e}function Z(t){return Array.isArray(t)?T(t).map(Z).toList():Q(t)?B(t).map(Z).toMap():t}function Q(t){return t&&(t.constructor===Object||void 0===t.constructor)}function tt(t){return t>>>1&1073741824|3221225471&t}function et(t){if(t===!1||null===t||void 0===t)return 0;if("function"==typeof t.valueOf&&(t=t.valueOf(),t===!1||null===t||void 0===t))return 0;if(t===!0)return 1;var e=typeof t;if("number"===e){var n=0|t;for(n!==t&&(n^=4294967295*t);t>4294967295;)t/=4294967295,n^=t;return tt(n)}return"string"===e?t.length>On?nt(t):rt(t):"function"==typeof t.hashCode?t.hashCode():it(t)}function nt(t){var e=Pn[t];return void 0===e&&(e=rt(t),Rn===qn&&(Rn=0,Pn={}),Rn++,Pn[t]=e),e}function rt(t){for(var e=0,n=0;t.length>n;n++)e=31*e+t.charCodeAt(n)|0;return tt(e)}function it(t){var e;if(Tn&&(e=En.get(t),void 0!==e))return e;if(e=t[Cn],void 0!==e)return e;if(!Bn){if(e=t.propertyIsEnumerable&&t.propertyIsEnumerable[Cn],void 0!==e)return e;if(e=ot(t),void 0!==e)return e}if(e=++Dn,1073741824&Dn&&(Dn=0),Tn)En.set(t,e);else{if(void 0!==Mn&&Mn(t)===!1)throw Error("Non-extensible objects are not allowed as keys.");if(Bn)Object.defineProperty(t,Cn,{enumerable:!1,configurable:!1,writable:!1,value:e});else if(void 0!==t.propertyIsEnumerable&&t.propertyIsEnumerable===t.constructor.prototype.propertyIsEnumerable)t.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},t.propertyIsEnumerable[Cn]=e;else{if(void 0===t.nodeType)throw Error("Unable to set a non-enumerable property on object.");t[Cn]=e}}return e}function ot(t){if(t&&t.nodeType>0)switch(t.nodeType){case 1:return t.uniqueID;case 9:return t.documentElement&&t.documentElement.uniqueID}}function st(t,e){if(!t)throw Error(e)}function at(t){st(t!==1/0,"Cannot perform this action with an infinite size.")}function ut(t,e){this._iter=t,this._useKeys=e,this.size=t.size}function ct(t){this._iter=t,this.size=t.size}function ht(t){this._iter=t,this.size=t.size}function ft(t){this._iter=t,this.size=t.size}function pt(t){var e=Ct(t);return e._iter=t,e.size=t.size,e.flip=function(){return t},e.reverse=function(){var e=t.reverse.apply(this);return e.flip=function(){return t.reverse()},e},e.has=function(e){return t.includes(e)},e.includes=function(e){return t.has(e)},e.cacheResult=Ot,e.__iterateUncached=function(e,n){var r=this;return t.__iterate(function(t,n){return e(n,t,r)!==!1},n)},e.__iteratorUncached=function(e,n){if(e===bn){var r=t.__iterator(e,n);return new b(function(){var t=r.next();if(!t.done){var e=t.value[0];t.value[0]=t.value[1],t.value[1]=e}return t})}return t.__iterator(e===wn?gn:wn,n)},e}function lt(t,e,n){var r=Ct(t);return r.size=t.size,r.has=function(e){return t.has(e)},r.get=function(r,i){var o=t.get(r,pn);return o===pn?i:e.call(n,o,r,t)},r.__iterateUncached=function(r,i){var o=this;return t.__iterate(function(t,i,s){return r(e.call(n,t,i,s),i,o)!==!1},i)},r.__iteratorUncached=function(r,i){var o=t.__iterator(bn,i);return new b(function(){var i=o.next();if(i.done)return i;var s=i.value,a=s[0];return k(r,a,e.call(n,s[1],a,t),i)})},r}function dt(t,e){var n=Ct(t);return n._iter=t,n.size=t.size,n.reverse=function(){return t},t.flip&&(n.flip=function(){var e=pt(t);return e.reverse=function(){return t.flip()},e}),n.get=function(n,r){return t.get(e?n:-1-n,r)},n.has=function(n){return t.has(e?n:-1-n)},n.includes=function(e){return t.includes(e)},n.cacheResult=Ot,n.__iterate=function(e,n){var r=this;return t.__iterate(function(t,n){return e(t,n,r)},!n)},n.__iterator=function(e,n){return t.__iterator(e,!n)},n}function _t(t,e,n,r){var i=Ct(t);return r&&(i.has=function(r){var i=t.get(r,pn);return i!==pn&&!!e.call(n,i,r,t)},i.get=function(r,i){var o=t.get(r,pn);return o!==pn&&e.call(n,o,r,t)?o:i}),i.__iterateUncached=function(i,o){var s=this,a=0;return t.__iterate(function(t,o,u){return e.call(n,t,o,u)?(a++,i(t,r?o:a-1,s)):void 0},o),a},i.__iteratorUncached=function(i,o){var s=t.__iterator(bn,o),a=0;return new b(function(){for(;;){var o=s.next();if(o.done)return o;var u=o.value,c=u[0],h=u[1];if(e.call(n,h,c,t))return k(i,r?c:a++,h,o)}})},i}function vt(t,e,n){var r=Pt().asMutable();return t.__iterate(function(i,o){r.update(e.call(n,i,o,t),0,function(t){return t+1})}),r.asImmutable()}function yt(t,e,n){var r=y(t),i=(w(t)?Se():Pt()).asMutable();t.__iterate(function(o,s){i.update(e.call(n,o,s,t),function(t){return t=t||[],t.push(r?[s,o]:o),t})});var o=Dt(t);return i.map(function(e){return Mt(t,o(e))})}function mt(t,e,n,r){var i=t.size;if(void 0!==e&&(e=0|e),void 0!==n&&(n=0|n),u(e,n,i))return t;var o=c(e,i),a=h(n,i);if(o!==o||a!==a)return mt(t.toSeq().cacheResult(),e,n,r);var f,p=a-o;p===p&&(f=0>p?0:p);var l=Ct(t);return l.size=0===f?f:t.size&&f||void 0,!r&&P(t)&&f>=0&&(l.get=function(e,n){return e=s(this,e),e>=0&&f>e?t.get(e+o,n):n}),l.__iterateUncached=function(e,n){var i=this;if(0===f)return 0;if(n)return this.cacheResult().__iterate(e,n);var s=0,a=!0,u=0;return t.__iterate(function(t,n){return a&&(a=s++<o)?void 0:(u++,e(t,r?n:u-1,i)!==!1&&u!==f)}),u},l.__iteratorUncached=function(e,n){if(0!==f&&n)return this.cacheResult().__iterator(e,n);var i=0!==f&&t.__iterator(e,n),s=0,a=0;return new b(function(){for(;s++<o;)i.next();if(++a>f)return S();var t=i.next();return r||e===wn?t:e===gn?k(e,a-1,void 0,t):k(e,a-1,t.value[1],t)})},l}function gt(t,e,n){var r=Ct(t);return r.__iterateUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterate(r,i);var s=0;return t.__iterate(function(t,i,a){return e.call(n,t,i,a)&&++s&&r(t,i,o)}),s},r.__iteratorUncached=function(r,i){var o=this;if(i)return this.cacheResult().__iterator(r,i);var s=t.__iterator(bn,i),a=!0;return new b(function(){if(!a)return S();var t=s.next();if(t.done)return t;var i=t.value,u=i[0],c=i[1];return e.call(n,c,u,o)?r===bn?t:k(r,u,c,t):(a=!1,S())})},r}function wt(t,e,n,r){var i=Ct(t);return i.__iterateUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterate(i,o);var a=!0,u=0;return t.__iterate(function(t,o,c){return a&&(a=e.call(n,t,o,c))?void 0:(u++,i(t,r?o:u-1,s))}),u},i.__iteratorUncached=function(i,o){var s=this;if(o)return this.cacheResult().__iterator(i,o);var a=t.__iterator(bn,o),u=!0,c=0;return new b(function(){var t,o,h;do{if(t=a.next(),t.done)return r||i===wn?t:i===gn?k(i,c++,void 0,t):k(i,c++,t.value[1],t);var f=t.value;o=f[0],h=f[1],u&&(u=e.call(n,h,o,s))}while(u);return i===bn?t:k(i,o,h,t)})},i}function bt(t,e){var n=y(t),r=[t].concat(e).map(function(t){return v(t)?n&&(t=l(t)):t=n?L(t):j(Array.isArray(t)?t:[t]),t}).filter(function(t){return 0!==t.size});if(0===r.length)return t;if(1===r.length){var i=r[0];if(i===t||n&&y(i)||m(t)&&m(i))return i}var o=new C(r);return n?o=o.toKeyedSeq():m(t)||(o=o.toSetSeq()),o=o.flatten(!0),o.size=r.reduce(function(t,e){if(void 0!==t){var n=e.size;if(void 0!==n)return t+n}},0),o}function kt(t,e,n){var r=Ct(t);return r.__iterateUncached=function(r,i){function o(t,u){var c=this;t.__iterate(function(t,i){return(!e||e>u)&&v(t)?o(t,u+1):r(t,n?i:s++,c)===!1&&(a=!0),!a},i)}var s=0,a=!1;return o(t,0),s},r.__iteratorUncached=function(r,i){var o=t.__iterator(r,i),s=[],a=0;return new b(function(){for(;o;){var t=o.next();if(t.done===!1){var u=t.value;if(r===bn&&(u=u[1]),e&&!(e>s.length)||!v(u))return n?t:k(r,a++,u,t);s.push(o),o=u.__iterator(r,i)}else o=s.pop()}return S()})},r}function St(t,e,n){var r=Dt(t);return t.toSeq().map(function(i,o){return r(e.call(n,i,o,t))}).flatten(!0)}function It(t,e){var n=Ct(t);return n.size=t.size&&2*t.size-1,n.__iterateUncached=function(n,r){var i=this,o=0;return t.__iterate(function(t){return(!o||n(e,o++,i)!==!1)&&n(t,o++,i)!==!1},r),o},n.__iteratorUncached=function(n,r){var i,o=t.__iterator(wn,r),s=0;return new b(function(){return(!i||s%2)&&(i=o.next(),i.done)?i:s%2?k(n,s++,e):k(n,s++,i.value,i)})},n}function zt(t,e,n){e||(e=qt);var r=y(t),i=0,o=t.toSeq().map(function(e,r){return[r,e,i++,n?n(e,r,t):e]}).toArray();return o.sort(function(t,n){return e(t[3],n[3])||t[2]-n[2]}).forEach(r?function(t,e){o[e].length=2}:function(t,e){o[e]=t[1]}),r?B(o):m(t)?T(o):D(o)}function xt(t,e,n){if(e||(e=qt),n){var r=t.toSeq().map(function(e,r){return[e,n(e,r,t)]}).reduce(function(t,n){return Et(e,t[1],n[1])?n:t});return r&&r[0]}return t.reduce(function(t,n){return Et(e,t,n)?n:t})}function Et(t,e,n){var r=t(n,e);return 0===r&&n!==e&&(void 0===n||null===n||n!==n)||r>0}function At(t,e,n){var r=Ct(t);return r.size=new C(n).map(function(t){return t.size}).min(),r.__iterate=function(t,e){for(var n,r=this.__iterator(wn,e),i=0;!(n=r.next()).done&&t(n.value,i++,this)!==!1;);return i},r.__iteratorUncached=function(t,r){var i=n.map(function(t){return t=p(t),x(r?t.reverse():t)}),o=0,s=!1;return new b(function(){var n;return s||(n=i.map(function(t){return t.next()}),s=n.some(function(t){return t.done})),s?S():k(t,o++,e.apply(null,n.map(function(t){return t.value})))})},r}function Mt(t,e){return P(t)?e:t.constructor(e)}function Bt(t){if(t!==Object(t))throw new TypeError("Expected [K, V] tuple: "+t)}function Tt(t){return at(t.size),o(t)}function Dt(t){return y(t)?l:m(t)?d:_}function Ct(t){return Object.create((y(t)?B:m(t)?T:D).prototype)}function Ot(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):M.prototype.cacheResult.call(this)}function qt(t,e){return t>e?1:e>t?-1:0}function Rt(t){var e=x(t);if(!e){if(!A(t))throw new TypeError("Expected iterable or array-like: "+t);e=x(p(t))}return e}function Pt(t){return null===t||void 0===t?Vt():Nt(t)&&!w(t)?t:Vt().withMutations(function(e){var n=l(t);at(n.size),n.forEach(function(t,n){return e.set(n,t)})})}function Nt(t){return!(!t||!t[Nn])}function Lt(t,e){this.ownerID=t,this.entries=e}function jt(t,e,n){this.ownerID=t,this.bitmap=e,this.nodes=n}function Ut(t,e,n){this.ownerID=t,this.count=e,this.nodes=n}function Kt(t,e,n){this.ownerID=t,this.keyHash=e,this.entries=n}function Wt(t,e,n){this.ownerID=t,this.keyHash=e,this.entry=n}function Ft(t,e,n){this._type=e,this._reverse=n,this._stack=t._root&&Jt(t._root)}function Ht(t,e){return k(t,e[0],e[1])}function Jt(t,e){return{node:t,index:0,__prev:e}}function Gt(t,e,n,r){var i=Object.create(Ln);return i.size=t,i._root=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function Vt(){return jn||(jn=Gt(0))}function Yt(t,n,r){var i,o;if(t._root){var s=e(ln),a=e(dn);if(i=$t(t._root,t.__ownerID,0,void 0,n,r,s,a),!a.value)return t;o=t.size+(s.value?r===pn?-1:1:0)}else{if(r===pn)return t;o=1,i=new Lt(t.__ownerID,[[n,r]])}return t.__ownerID?(t.size=o,t._root=i,t.__hash=void 0,t.__altered=!0,t):i?Gt(o,i):Vt()}function $t(t,e,r,i,o,s,a,u){return t?t.update(e,r,i,o,s,a,u):s===pn?t:(n(u),n(a),new Wt(e,i,[o,s]))}function Xt(t){return t.constructor===Wt||t.constructor===Kt}function Zt(t,e,n,r,i){if(t.keyHash===r)return new Kt(e,r,[t.entry,i]);var o,s=(0===n?t.keyHash:t.keyHash>>>n)&fn,a=(0===n?r:r>>>n)&fn,u=s===a?[Zt(t,e,n+cn,r,i)]:(o=new Wt(e,r,i),a>s?[t,o]:[o,t]);return new jt(e,1<<s|1<<a,u)}function Qt(t,e,n,i){t||(t=new r);for(var o=new Wt(t,et(n),[n,i]),s=0;e.length>s;s++){var a=e[s];o=o.update(t,0,void 0,a[0],a[1])}return o}function te(t,e,n,r){for(var i=0,o=0,s=Array(n),a=0,u=1,c=e.length;c>a;a++,u<<=1){var h=e[a];void 0!==h&&a!==r&&(i|=u,s[o++]=h)}return new jt(t,i,s)}function ee(t,e,n,r,i){for(var o=0,s=Array(hn),a=0;0!==n;a++,n>>>=1)s[a]=1&n?e[o++]:void 0;return s[r]=i,new Ut(t,o+1,s)}function ne(t,e,n){for(var r=[],i=0;n.length>i;i++){var o=n[i],s=l(o);v(o)||(s=s.map(function(t){return $(t)})),r.push(s)}return ie(t,e,r)}function re(t){return function(e,n,r){return e&&e.mergeDeepWith&&v(n)?e.mergeDeepWith(t,n):t?t(e,n,r):n}}function ie(t,e,n){return n=n.filter(function(t){return 0!==t.size}),0===n.length?t:0!==t.size||t.__ownerID||1!==n.length?t.withMutations(function(t){for(var r=e?function(n,r){t.update(r,pn,function(t){return t===pn?n:e(t,n,r)})}:function(e,n){t.set(n,e)},i=0;n.length>i;i++)n[i].forEach(r)}):t.constructor(n[0])}function oe(t,e,n,r){var i=t===pn,o=e.next();if(o.done){var s=i?n:t,a=r(s);return a===s?t:a}st(i||t&&t.set,"invalid keyPath");var u=o.value,c=i?pn:t.get(u,pn),h=oe(c,e,n,r);return h===c?t:h===pn?t.remove(u):(i?Vt():t).set(u,h)}function se(t){return t-=t>>1&1431655765,t=(858993459&t)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,t+=t>>16,127&t}function ae(t,e,n,r){var o=r?t:i(t);return o[e]=n,o}function ue(t,e,n,r){var i=t.length+1;if(r&&e+1===i)return t[e]=n,t;for(var o=Array(i),s=0,a=0;i>a;a++)a===e?(o[a]=n,s=-1):o[a]=t[a+s];return o}function ce(t,e,n){var r=t.length-1;if(n&&e===r)return t.pop(),t;for(var i=Array(r),o=0,s=0;r>s;s++)s===e&&(o=1),i[s]=t[s+o];return i}function he(t){var e=_e();if(null===t||void 0===t)return e;if(fe(t))return t;var n=d(t),r=n.size;return 0===r?e:(at(r),r>0&&hn>r?de(0,r,cn,null,new pe(n.toArray())):e.withMutations(function(t){t.setSize(r),n.forEach(function(e,n){return t.set(n,e)})}))}function fe(t){return!(!t||!t[Fn])}function pe(t,e){this.array=t,this.ownerID=e}function le(t,e){function n(t,e,n){return 0===e?r(t,n):i(t,e,n)}function r(t,n){var r=n===a?u&&u.array:t&&t.array,i=n>o?0:o-n,c=s-n;return c>hn&&(c=hn),function(){if(i===c)return Gn;var t=e?--c:i++;return r&&r[t]}}function i(t,r,i){var a,u=t&&t.array,c=i>o?0:o-i>>r,h=(s-i>>r)+1;return h>hn&&(h=hn),function(){for(;;){if(a){var t=a();if(t!==Gn)return t;a=null}if(c===h)return Gn;var o=e?--h:c++;a=n(u&&u[o],r-cn,i+(o<<r))}}}var o=t._origin,s=t._capacity,a=ke(s),u=t._tail;return n(t._root,t._level,0)}function de(t,e,n,r,i,o,s){var a=Object.create(Hn);return a.size=e-t,a._origin=t,a._capacity=e,a._level=n,a._root=r,a._tail=i,a.__ownerID=o,a.__hash=s,a.__altered=!1,a}function _e(){return Jn||(Jn=de(0,0,cn))}function ve(t,n,r){if(n=s(t,n),n!==n)return t;if(n>=t.size||0>n)return t.withMutations(function(t){0>n?we(t,n).set(0,r):we(t,0,n+1).set(n,r)});n+=t._origin;var i=t._tail,o=t._root,a=e(dn);return n>=ke(t._capacity)?i=ye(i,t.__ownerID,0,n,r,a):o=ye(o,t.__ownerID,t._level,n,r,a),a.value?t.__ownerID?(t._root=o,t._tail=i,t.__hash=void 0,t.__altered=!0,t):de(t._origin,t._capacity,t._level,o,i):t}function ye(t,e,r,i,o,s){var a=i>>>r&fn,u=t&&t.array.length>a;if(!u&&void 0===o)return t;var c;if(r>0){var h=t&&t.array[a],f=ye(h,e,r-cn,i,o,s);return f===h?t:(c=me(t,e),c.array[a]=f,c)}return u&&t.array[a]===o?t:(n(s),c=me(t,e),void 0===o&&a===c.array.length-1?c.array.pop():c.array[a]=o,c)}function me(t,e){return e&&t&&e===t.ownerID?t:new pe(t?t.array.slice():[],e)}function ge(t,e){if(e>=ke(t._capacity))return t._tail;if(1<<t._level+cn>e){for(var n=t._root,r=t._level;n&&r>0;)n=n.array[e>>>r&fn],r-=cn;return n}}function we(t,e,n){void 0!==e&&(e=0|e),void 0!==n&&(n=0|n);var i=t.__ownerID||new r,o=t._origin,s=t._capacity,a=o+e,u=void 0===n?s:0>n?s+n:o+n;if(a===o&&u===s)return t;if(a>=u)return t.clear();for(var c=t._level,h=t._root,f=0;0>a+f;)h=new pe(h&&h.array.length?[void 0,h]:[],i),c+=cn,f+=1<<c;f&&(a+=f,o+=f,u+=f,s+=f);for(var p=ke(s),l=ke(u);l>=1<<c+cn;)h=new pe(h&&h.array.length?[h]:[],i),c+=cn;var d=t._tail,_=p>l?ge(t,u-1):l>p?new pe([],i):d;if(d&&l>p&&s>a&&d.array.length){h=me(h,i);for(var v=h,y=c;y>cn;y-=cn){var m=p>>>y&fn;v=v.array[m]=me(v.array[m],i)}v.array[p>>>cn&fn]=d}if(s>u&&(_=_&&_.removeAfter(i,0,u)),a>=l)a-=l,u-=l,c=cn,h=null,_=_&&_.removeBefore(i,0,a);else if(a>o||p>l){for(f=0;h;){var g=a>>>c&fn;if(g!==l>>>c&fn)break;g&&(f+=(1<<c)*g),c-=cn,h=h.array[g]}h&&a>o&&(h=h.removeBefore(i,c,a-f)),h&&p>l&&(h=h.removeAfter(i,c,l-f)),f&&(a-=f,u-=f)}return t.__ownerID?(t.size=u-a,t._origin=a,t._capacity=u,t._level=c,t._root=h,t._tail=_,t.__hash=void 0,t.__altered=!0,t):de(a,u,c,h,_)}function be(t,e,n){for(var r=[],i=0,o=0;n.length>o;o++){var s=n[o],a=d(s);a.size>i&&(i=a.size),v(s)||(a=a.map(function(t){return $(t)})),r.push(a)}return i>t.size&&(t=t.setSize(i)),ie(t,e,r)}function ke(t){return hn>t?0:t-1>>>cn<<cn}function Se(t){return null===t||void 0===t?xe():Ie(t)?t:xe().withMutations(function(e){var n=l(t);at(n.size),n.forEach(function(t,n){return e.set(n,t)})})}function Ie(t){return Nt(t)&&w(t)}function ze(t,e,n,r){var i=Object.create(Se.prototype);return i.size=t?t.size:0,i._map=t,i._list=e,i.__ownerID=n,i.__hash=r,i}function xe(){return Vn||(Vn=ze(Vt(),_e()))}function Ee(t,e,n){var r,i,o=t._map,s=t._list,a=o.get(e),u=void 0!==a;if(n===pn){if(!u)return t;s.size>=hn&&s.size>=2*o.size?(i=s.filter(function(t,e){return void 0!==t&&a!==e}),r=i.toKeyedSeq().map(function(t){return t[0]}).flip().toMap(),t.__ownerID&&(r.__ownerID=i.__ownerID=t.__ownerID)):(r=o.remove(e),i=a===s.size-1?s.pop():s.set(a,void 0))}else if(u){if(n===s.get(a)[1])return t;r=o,i=s.set(a,[e,n])}else r=o.set(e,s.size),i=s.set(s.size,[e,n]);return t.__ownerID?(t.size=r.size,t._map=r,t._list=i,t.__hash=void 0,t):ze(r,i)}function Ae(t){return null===t||void 0===t?Te():Me(t)?t:Te().unshiftAll(t)}function Me(t){return!(!t||!t[Yn])}function Be(t,e,n,r){var i=Object.create($n);return i.size=t,i._head=e,i.__ownerID=n,i.__hash=r,i.__altered=!1,i}function Te(){return Xn||(Xn=Be(0))}function De(t){return null===t||void 0===t?Re():Ce(t)&&!w(t)?t:Re().withMutations(function(e){var n=_(t);at(n.size),n.forEach(function(t){return e.add(t)})})}function Ce(t){return!(!t||!t[Zn])}function Oe(t,e){return t.__ownerID?(t.size=e.size,t._map=e,t):e===t._map?t:0===e.size?t.__empty():t.__make(e)}function qe(t,e){var n=Object.create(Qn);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function Re(){return tr||(tr=qe(Vt()))}function Pe(t){return null===t||void 0===t?je():Ne(t)?t:je().withMutations(function(e){var n=_(t);at(n.size),n.forEach(function(t){return e.add(t)})})}function Ne(t){return Ce(t)&&w(t)}function Le(t,e){var n=Object.create(er);return n.size=t?t.size:0,n._map=t,n.__ownerID=e,n}function je(){return nr||(nr=Le(xe()))}function Ue(t,e){var n,r=function(o){if(o instanceof r)return o;if(!(this instanceof r))return new r(o);if(!n){n=!0;var s=Object.keys(t);Fe(i,s),i.size=s.length,i._name=e,i._keys=s,i._defaultValues=t}this._map=Pt(o)},i=r.prototype=Object.create(rr);return i.constructor=r,r}function Ke(t,e,n){var r=Object.create(Object.getPrototypeOf(t));return r._map=e,r.__ownerID=n,r}function We(t){return t._name||t.constructor.name||"Record"}function Fe(t,e){try{e.forEach(He.bind(void 0,t))}catch(n){}}function He(t,e){Object.defineProperty(t,e,{get:function(){return this.get(e)},set:function(t){st(this.__ownerID,"Cannot set on an immutable record."),this.set(e,t)}})}function Je(t,e){if(t===e)return!0;if(!v(e)||void 0!==t.size&&void 0!==e.size&&t.size!==e.size||void 0!==t.__hash&&void 0!==e.__hash&&t.__hash!==e.__hash||y(t)!==y(e)||m(t)!==m(e)||w(t)!==w(e))return!1;if(0===t.size&&0===e.size)return!0;var n=!g(t);if(w(t)){var r=t.entries();return e.every(function(t,e){var i=r.next().value;return i&&Y(i[1],t)&&(n||Y(i[0],e))})&&r.next().done}var i=!1;if(void 0===t.size)if(void 0===e.size)"function"==typeof t.cacheResult&&t.cacheResult();else{i=!0;var o=t;t=e,e=o}var s=!0,a=e.__iterate(function(e,r){return(n?t.has(e):i?Y(e,t.get(r,pn)):Y(t.get(r,pn),e))?void 0:(s=!1,!1)});return s&&t.size===a}function Ge(t,e,n){if(!(this instanceof Ge))return new Ge(t,e,n);if(st(0!==n,"Cannot step a Range by 0"),t=t||0,void 0===e&&(e=1/0),n=void 0===n?1:Math.abs(n),t>e&&(n=-n),this._start=t,this._end=e,this._step=n,this.size=Math.max(0,Math.ceil((e-t)/n-1)+1),0===this.size){if(ir)return ir;ir=this}}function Ve(t,e){if(!(this instanceof Ve))return new Ve(t,e);if(this._value=t,this.size=void 0===e?1/0:Math.max(0,e),0===this.size){if(or)return or;or=this}}function Ye(t,e){var n=function(n){t.prototype[n]=e[n]};return Object.keys(e).forEach(n),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(e).forEach(n),t}function $e(t,e){return e}function Xe(t,e){return[e,t]}function Ze(t){return function(){return!t.apply(this,arguments)}}function Qe(t){return function(){return-t.apply(this,arguments)}}function tn(t){return"string"==typeof t?JSON.stringify(t):t}function en(){return i(arguments)}function nn(t,e){return e>t?1:t>e?-1:0}function rn(t){if(t.size===1/0)return 0;var e=w(t),n=y(t),r=e?1:0,i=t.__iterate(n?e?function(t,e){r=31*r+sn(et(t),et(e))|0}:function(t,e){r=r+sn(et(t),et(e))|0}:e?function(t){r=31*r+et(t)|0}:function(t){r=r+et(t)|0});return on(i,r)}function on(t,e){return e=An(e,3432918353),e=An(e<<15|e>>>-15,461845907),e=An(e<<13|e>>>-13,5),e=(e+3864292196|0)^t,e=An(e^e>>>16,2246822507),e=An(e^e>>>13,3266489909),e=tt(e^e>>>16)}function sn(t,e){return t^e+2654435769+(t<<6)+(t>>2)|0}var an=Array.prototype.slice,un="delete",cn=5,hn=1<<cn,fn=hn-1,pn={},ln={value:!1},dn={value:!1};t(l,p),t(d,p),t(_,p),p.isIterable=v,p.isKeyed=y,p.isIndexed=m,p.isAssociative=g,p.isOrdered=w,p.Keyed=l,p.Indexed=d,p.Set=_;var _n="@@__IMMUTABLE_ITERABLE__@@",vn="@@__IMMUTABLE_KEYED__@@",yn="@@__IMMUTABLE_INDEXED__@@",mn="@@__IMMUTABLE_ORDERED__@@",gn=0,wn=1,bn=2,kn="function"==typeof Symbol&&Symbol.iterator,Sn="@@iterator",In=kn||Sn;b.prototype.toString=function(){return"[Iterator]"},b.KEYS=gn,b.VALUES=wn,b.ENTRIES=bn,b.prototype.inspect=b.prototype.toSource=function(){return""+this},b.prototype[In]=function(){return this},t(M,p),M.of=function(){return M(arguments)},M.prototype.toSeq=function(){return this},M.prototype.toString=function(){return this.__toString("Seq {","}")},M.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},M.prototype.__iterate=function(t,e){return W(this,t,e,!0)},M.prototype.__iterator=function(t,e){return F(this,t,e,!0)},t(B,M),B.prototype.toKeyedSeq=function(){return this},t(T,M),T.of=function(){return T(arguments)},T.prototype.toIndexedSeq=function(){return this},T.prototype.toString=function(){return this.__toString("Seq [","]")},T.prototype.__iterate=function(t,e){return W(this,t,e,!1)},T.prototype.__iterator=function(t,e){return F(this,t,e,!1)},t(D,M),D.of=function(){return D(arguments)},D.prototype.toSetSeq=function(){return this},M.isSeq=P,M.Keyed=B,M.Set=D,M.Indexed=T;var zn="@@__IMMUTABLE_SEQ__@@";M.prototype[zn]=!0,t(C,T),C.prototype.get=function(t,e){
return this.has(t)?this._array[s(this,t)]:e},C.prototype.__iterate=function(t,e){for(var n=this._array,r=n.length-1,i=0;r>=i;i++)if(t(n[e?r-i:i],i,this)===!1)return i+1;return i},C.prototype.__iterator=function(t,e){var n=this._array,r=n.length-1,i=0;return new b(function(){return i>r?S():k(t,i,n[e?r-i++:i++])})},t(O,B),O.prototype.get=function(t,e){return void 0===e||this.has(t)?this._object[t]:e},O.prototype.has=function(t){return this._object.hasOwnProperty(t)},O.prototype.__iterate=function(t,e){for(var n=this._object,r=this._keys,i=r.length-1,o=0;i>=o;o++){var s=r[e?i-o:o];if(t(n[s],s,this)===!1)return o+1}return o},O.prototype.__iterator=function(t,e){var n=this._object,r=this._keys,i=r.length-1,o=0;return new b(function(){var s=r[e?i-o:o];return o++>i?S():k(t,s,n[s])})},O.prototype[mn]=!0,t(q,T),q.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);var n=this._iterable,r=x(n),i=0;if(z(r))for(var o;!(o=r.next()).done&&t(o.value,i++,this)!==!1;);return i},q.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=this._iterable,r=x(n);if(!z(r))return new b(S);var i=0;return new b(function(){var e=r.next();return e.done?e:k(t,i++,e.value)})},t(R,T),R.prototype.__iterateUncached=function(t,e){if(e)return this.cacheResult().__iterate(t,e);for(var n=this._iterator,r=this._iteratorCache,i=0;r.length>i;)if(t(r[i],i++,this)===!1)return i;for(var o;!(o=n.next()).done;){var s=o.value;if(r[i]=s,t(s,i++,this)===!1)break}return i},R.prototype.__iteratorUncached=function(t,e){if(e)return this.cacheResult().__iterator(t,e);var n=this._iterator,r=this._iteratorCache,i=0;return new b(function(){if(i>=r.length){var e=n.next();if(e.done)return e;r[i]=e.value}return k(t,i,r[i++])})};var xn;t(H,p),t(J,H),t(G,H),t(V,H),H.Keyed=J,H.Indexed=G,H.Set=V;var En,An="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(t,e){t=0|t,e=0|e;var n=65535&t,r=65535&e;return n*r+((t>>>16)*r+n*(e>>>16)<<16>>>0)|0},Mn=Object.isExtensible,Bn=function(){try{return Object.defineProperty({},"@",{}),!0}catch(t){return!1}}(),Tn="function"==typeof WeakMap;Tn&&(En=new WeakMap);var Dn=0,Cn="__immutablehash__";"function"==typeof Symbol&&(Cn=Symbol(Cn));var On=16,qn=255,Rn=0,Pn={};t(ut,B),ut.prototype.get=function(t,e){return this._iter.get(t,e)},ut.prototype.has=function(t){return this._iter.has(t)},ut.prototype.valueSeq=function(){return this._iter.valueSeq()},ut.prototype.reverse=function(){var t=this,e=dt(this,!0);return this._useKeys||(e.valueSeq=function(){return t._iter.toSeq().reverse()}),e},ut.prototype.map=function(t,e){var n=this,r=lt(this,t,e);return this._useKeys||(r.valueSeq=function(){return n._iter.toSeq().map(t,e)}),r},ut.prototype.__iterate=function(t,e){var n,r=this;return this._iter.__iterate(this._useKeys?function(e,n){return t(e,n,r)}:(n=e?Tt(this):0,function(i){return t(i,e?--n:n++,r)}),e)},ut.prototype.__iterator=function(t,e){if(this._useKeys)return this._iter.__iterator(t,e);var n=this._iter.__iterator(wn,e),r=e?Tt(this):0;return new b(function(){var i=n.next();return i.done?i:k(t,e?--r:r++,i.value,i)})},ut.prototype[mn]=!0,t(ct,T),ct.prototype.includes=function(t){return this._iter.includes(t)},ct.prototype.__iterate=function(t,e){var n=this,r=0;return this._iter.__iterate(function(e){return t(e,r++,n)},e)},ct.prototype.__iterator=function(t,e){var n=this._iter.__iterator(wn,e),r=0;return new b(function(){var e=n.next();return e.done?e:k(t,r++,e.value,e)})},t(ht,D),ht.prototype.has=function(t){return this._iter.includes(t)},ht.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){return t(e,e,n)},e)},ht.prototype.__iterator=function(t,e){var n=this._iter.__iterator(wn,e);return new b(function(){var e=n.next();return e.done?e:k(t,e.value,e.value,e)})},t(ft,B),ft.prototype.entrySeq=function(){return this._iter.toSeq()},ft.prototype.__iterate=function(t,e){var n=this;return this._iter.__iterate(function(e){if(e){Bt(e);var r=v(e);return t(r?e.get(1):e[1],r?e.get(0):e[0],n)}},e)},ft.prototype.__iterator=function(t,e){var n=this._iter.__iterator(wn,e);return new b(function(){for(;;){var e=n.next();if(e.done)return e;var r=e.value;if(r){Bt(r);var i=v(r);return k(t,i?r.get(0):r[0],i?r.get(1):r[1],e)}}})},ct.prototype.cacheResult=ut.prototype.cacheResult=ht.prototype.cacheResult=ft.prototype.cacheResult=Ot,t(Pt,J),Pt.prototype.toString=function(){return this.__toString("Map {","}")},Pt.prototype.get=function(t,e){return this._root?this._root.get(0,void 0,t,e):e},Pt.prototype.set=function(t,e){return Yt(this,t,e)},Pt.prototype.setIn=function(t,e){return this.updateIn(t,pn,function(){return e})},Pt.prototype.remove=function(t){return Yt(this,t,pn)},Pt.prototype.deleteIn=function(t){return this.updateIn(t,function(){return pn})},Pt.prototype.update=function(t,e,n){return 1===arguments.length?t(this):this.updateIn([t],e,n)},Pt.prototype.updateIn=function(t,e,n){n||(n=e,e=void 0);var r=oe(this,Rt(t),e,n);return r===pn?void 0:r},Pt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Vt()},Pt.prototype.merge=function(){return ne(this,void 0,arguments)},Pt.prototype.mergeWith=function(t){var e=an.call(arguments,1);return ne(this,t,e)},Pt.prototype.mergeIn=function(t){var e=an.call(arguments,1);return this.updateIn(t,Vt(),function(t){return"function"==typeof t.merge?t.merge.apply(t,e):e[e.length-1]})},Pt.prototype.mergeDeep=function(){return ne(this,re(void 0),arguments)},Pt.prototype.mergeDeepWith=function(t){var e=an.call(arguments,1);return ne(this,re(t),e)},Pt.prototype.mergeDeepIn=function(t){var e=an.call(arguments,1);return this.updateIn(t,Vt(),function(t){return"function"==typeof t.mergeDeep?t.mergeDeep.apply(t,e):e[e.length-1]})},Pt.prototype.sort=function(t){return Se(zt(this,t))},Pt.prototype.sortBy=function(t,e){return Se(zt(this,e,t))},Pt.prototype.withMutations=function(t){var e=this.asMutable();return t(e),e.wasAltered()?e.__ensureOwner(this.__ownerID):this},Pt.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new r)},Pt.prototype.asImmutable=function(){return this.__ensureOwner()},Pt.prototype.wasAltered=function(){return this.__altered},Pt.prototype.__iterator=function(t,e){return new Ft(this,t,e)},Pt.prototype.__iterate=function(t,e){var n=this,r=0;return this._root&&this._root.iterate(function(e){return r++,t(e[1],e[0],n)},e),r},Pt.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Gt(this.size,this._root,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Pt.isMap=Nt;var Nn="@@__IMMUTABLE_MAP__@@",Ln=Pt.prototype;Ln[Nn]=!0,Ln[un]=Ln.remove,Ln.removeIn=Ln.deleteIn,Lt.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,s=i.length;s>o;o++)if(Y(n,i[o][0]))return i[o][1];return r},Lt.prototype.update=function(t,e,r,o,s,a,u){for(var c=s===pn,h=this.entries,f=0,p=h.length;p>f&&!Y(o,h[f][0]);f++);var l=p>f;if(l?h[f][1]===s:c)return this;if(n(u),(c||!l)&&n(a),!c||1!==h.length){if(!l&&!c&&h.length>=Un)return Qt(t,h,o,s);var d=t&&t===this.ownerID,_=d?h:i(h);return l?c?f===p-1?_.pop():_[f]=_.pop():_[f]=[o,s]:_.push([o,s]),d?(this.entries=_,this):new Lt(t,_)}},jt.prototype.get=function(t,e,n,r){void 0===e&&(e=et(n));var i=1<<((0===t?e:e>>>t)&fn),o=this.bitmap;return 0===(o&i)?r:this.nodes[se(o&i-1)].get(t+cn,e,n,r)},jt.prototype.update=function(t,e,n,r,i,o,s){void 0===n&&(n=et(r));var a=(0===e?n:n>>>e)&fn,u=1<<a,c=this.bitmap,h=0!==(c&u);if(!h&&i===pn)return this;var f=se(c&u-1),p=this.nodes,l=h?p[f]:void 0,d=$t(l,t,e+cn,n,r,i,o,s);if(d===l)return this;if(!h&&d&&p.length>=Kn)return ee(t,p,c,a,d);if(h&&!d&&2===p.length&&Xt(p[1^f]))return p[1^f];if(h&&d&&1===p.length&&Xt(d))return d;var _=t&&t===this.ownerID,v=h?d?c:c^u:c|u,y=h?d?ae(p,f,d,_):ce(p,f,_):ue(p,f,d,_);return _?(this.bitmap=v,this.nodes=y,this):new jt(t,v,y)},Ut.prototype.get=function(t,e,n,r){void 0===e&&(e=et(n));var i=(0===t?e:e>>>t)&fn,o=this.nodes[i];return o?o.get(t+cn,e,n,r):r},Ut.prototype.update=function(t,e,n,r,i,o,s){void 0===n&&(n=et(r));var a=(0===e?n:n>>>e)&fn,u=i===pn,c=this.nodes,h=c[a];if(u&&!h)return this;var f=$t(h,t,e+cn,n,r,i,o,s);if(f===h)return this;var p=this.count;if(h){if(!f&&(p--,Wn>p))return te(t,c,p,a)}else p++;var l=t&&t===this.ownerID,d=ae(c,a,f,l);return l?(this.count=p,this.nodes=d,this):new Ut(t,p,d)},Kt.prototype.get=function(t,e,n,r){for(var i=this.entries,o=0,s=i.length;s>o;o++)if(Y(n,i[o][0]))return i[o][1];return r},Kt.prototype.update=function(t,e,r,o,s,a,u){void 0===r&&(r=et(o));var c=s===pn;if(r!==this.keyHash)return c?this:(n(u),n(a),Zt(this,t,e,r,[o,s]));for(var h=this.entries,f=0,p=h.length;p>f&&!Y(o,h[f][0]);f++);var l=p>f;if(l?h[f][1]===s:c)return this;if(n(u),(c||!l)&&n(a),c&&2===p)return new Wt(t,this.keyHash,h[1^f]);var d=t&&t===this.ownerID,_=d?h:i(h);return l?c?f===p-1?_.pop():_[f]=_.pop():_[f]=[o,s]:_.push([o,s]),d?(this.entries=_,this):new Kt(t,this.keyHash,_)},Wt.prototype.get=function(t,e,n,r){return Y(n,this.entry[0])?this.entry[1]:r},Wt.prototype.update=function(t,e,r,i,o,s,a){var u=o===pn,c=Y(i,this.entry[0]);return(c?o===this.entry[1]:u)?this:(n(a),u?void n(s):c?t&&t===this.ownerID?(this.entry[1]=o,this):new Wt(t,this.keyHash,[i,o]):(n(s),Zt(this,t,e,et(i),[i,o])))},Lt.prototype.iterate=Kt.prototype.iterate=function(t,e){for(var n=this.entries,r=0,i=n.length-1;i>=r;r++)if(t(n[e?i-r:r])===!1)return!1},jt.prototype.iterate=Ut.prototype.iterate=function(t,e){for(var n=this.nodes,r=0,i=n.length-1;i>=r;r++){var o=n[e?i-r:r];if(o&&o.iterate(t,e)===!1)return!1}},Wt.prototype.iterate=function(t){return t(this.entry)},t(Ft,b),Ft.prototype.next=function(){for(var t=this._type,e=this._stack;e;){var n,r=e.node,i=e.index++;if(r.entry){if(0===i)return Ht(t,r.entry)}else if(r.entries){if(n=r.entries.length-1,n>=i)return Ht(t,r.entries[this._reverse?n-i:i])}else if(n=r.nodes.length-1,n>=i){var o=r.nodes[this._reverse?n-i:i];if(o){if(o.entry)return Ht(t,o.entry);e=this._stack=Jt(o,e)}continue}e=this._stack=this._stack.__prev}return S()};var jn,Un=hn/4,Kn=hn/2,Wn=hn/4;t(he,G),he.of=function(){return this(arguments)},he.prototype.toString=function(){return this.__toString("List [","]")},he.prototype.get=function(t,e){if(t=s(this,t),t>=0&&this.size>t){t+=this._origin;var n=ge(this,t);return n&&n.array[t&fn]}return e},he.prototype.set=function(t,e){return ve(this,t,e)},he.prototype.remove=function(t){return this.has(t)?0===t?this.shift():t===this.size-1?this.pop():this.splice(t,1):this},he.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=cn,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):_e()},he.prototype.push=function(){var t=arguments,e=this.size;return this.withMutations(function(n){we(n,0,e+t.length);for(var r=0;t.length>r;r++)n.set(e+r,t[r])})},he.prototype.pop=function(){return we(this,0,-1)},he.prototype.unshift=function(){var t=arguments;return this.withMutations(function(e){we(e,-t.length);for(var n=0;t.length>n;n++)e.set(n,t[n])})},he.prototype.shift=function(){return we(this,1)},he.prototype.merge=function(){return be(this,void 0,arguments)},he.prototype.mergeWith=function(t){var e=an.call(arguments,1);return be(this,t,e)},he.prototype.mergeDeep=function(){return be(this,re(void 0),arguments)},he.prototype.mergeDeepWith=function(t){var e=an.call(arguments,1);return be(this,re(t),e)},he.prototype.setSize=function(t){return we(this,0,t)},he.prototype.slice=function(t,e){var n=this.size;return u(t,e,n)?this:we(this,c(t,n),h(e,n))},he.prototype.__iterator=function(t,e){var n=0,r=le(this,e);return new b(function(){var e=r();return e===Gn?S():k(t,n++,e)})},he.prototype.__iterate=function(t,e){for(var n,r=0,i=le(this,e);(n=i())!==Gn&&t(n,r++,this)!==!1;);return r},he.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?de(this._origin,this._capacity,this._level,this._root,this._tail,t,this.__hash):(this.__ownerID=t,this)},he.isList=fe;var Fn="@@__IMMUTABLE_LIST__@@",Hn=he.prototype;Hn[Fn]=!0,Hn[un]=Hn.remove,Hn.setIn=Ln.setIn,Hn.deleteIn=Hn.removeIn=Ln.removeIn,Hn.update=Ln.update,Hn.updateIn=Ln.updateIn,Hn.mergeIn=Ln.mergeIn,Hn.mergeDeepIn=Ln.mergeDeepIn,Hn.withMutations=Ln.withMutations,Hn.asMutable=Ln.asMutable,Hn.asImmutable=Ln.asImmutable,Hn.wasAltered=Ln.wasAltered,pe.prototype.removeBefore=function(t,e,n){if(n===e?1<<e:0===this.array.length)return this;var r=n>>>e&fn;if(r>=this.array.length)return new pe([],t);var i,o=0===r;if(e>0){var s=this.array[r];if(i=s&&s.removeBefore(t,e-cn,n),i===s&&o)return this}if(o&&!i)return this;var a=me(this,t);if(!o)for(var u=0;r>u;u++)a.array[u]=void 0;return i&&(a.array[r]=i),a},pe.prototype.removeAfter=function(t,e,n){if(n===(e?1<<e:0)||0===this.array.length)return this;var r=n-1>>>e&fn;if(r>=this.array.length)return this;var i;if(e>0){var o=this.array[r];if(i=o&&o.removeAfter(t,e-cn,n),i===o&&r===this.array.length-1)return this}var s=me(this,t);return s.array.splice(r+1),i&&(s.array[r]=i),s};var Jn,Gn={};t(Se,Pt),Se.of=function(){return this(arguments)},Se.prototype.toString=function(){return this.__toString("OrderedMap {","}")},Se.prototype.get=function(t,e){var n=this._map.get(t);return void 0!==n?this._list.get(n)[1]:e},Se.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):xe()},Se.prototype.set=function(t,e){return Ee(this,t,e)},Se.prototype.remove=function(t){return Ee(this,t,pn)},Se.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},Se.prototype.__iterate=function(t,e){var n=this;return this._list.__iterate(function(e){return e&&t(e[1],e[0],n)},e)},Se.prototype.__iterator=function(t,e){return this._list.fromEntrySeq().__iterator(t,e)},Se.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t),n=this._list.__ensureOwner(t);return t?ze(e,n,t,this.__hash):(this.__ownerID=t,this._map=e,this._list=n,this)},Se.isOrderedMap=Ie,Se.prototype[mn]=!0,Se.prototype[un]=Se.prototype.remove;var Vn;t(Ae,G),Ae.of=function(){return this(arguments)},Ae.prototype.toString=function(){return this.__toString("Stack [","]")},Ae.prototype.get=function(t,e){var n=this._head;for(t=s(this,t);n&&t--;)n=n.next;return n?n.value:e},Ae.prototype.peek=function(){return this._head&&this._head.value},Ae.prototype.push=function(){if(0===arguments.length)return this;for(var t=this.size+arguments.length,e=this._head,n=arguments.length-1;n>=0;n--)e={value:arguments[n],next:e};return this.__ownerID?(this.size=t,this._head=e,this.__hash=void 0,this.__altered=!0,this):Be(t,e)},Ae.prototype.pushAll=function(t){if(t=d(t),0===t.size)return this;at(t.size);var e=this.size,n=this._head;return t.reverse().forEach(function(t){e++,n={value:t,next:n}}),this.__ownerID?(this.size=e,this._head=n,this.__hash=void 0,this.__altered=!0,this):Be(e,n)},Ae.prototype.pop=function(){return this.slice(1)},Ae.prototype.unshift=function(){return this.push.apply(this,arguments)},Ae.prototype.unshiftAll=function(t){return this.pushAll(t)},Ae.prototype.shift=function(){return this.pop.apply(this,arguments)},Ae.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Te()},Ae.prototype.slice=function(t,e){if(u(t,e,this.size))return this;var n=c(t,this.size),r=h(e,this.size);if(r!==this.size)return G.prototype.slice.call(this,t,e);for(var i=this.size-n,o=this._head;n--;)o=o.next;return this.__ownerID?(this.size=i,this._head=o,this.__hash=void 0,this.__altered=!0,this):Be(i,o)},Ae.prototype.__ensureOwner=function(t){return t===this.__ownerID?this:t?Be(this.size,this._head,t,this.__hash):(this.__ownerID=t,this.__altered=!1,this)},Ae.prototype.__iterate=function(t,e){if(e)return this.reverse().__iterate(t);for(var n=0,r=this._head;r&&t(r.value,n++,this)!==!1;)r=r.next;return n},Ae.prototype.__iterator=function(t,e){if(e)return this.reverse().__iterator(t);var n=0,r=this._head;return new b(function(){if(r){var e=r.value;return r=r.next,k(t,n++,e)}return S()})},Ae.isStack=Me;var Yn="@@__IMMUTABLE_STACK__@@",$n=Ae.prototype;$n[Yn]=!0,$n.withMutations=Ln.withMutations,$n.asMutable=Ln.asMutable,$n.asImmutable=Ln.asImmutable,$n.wasAltered=Ln.wasAltered;var Xn;t(De,V),De.of=function(){return this(arguments)},De.fromKeys=function(t){return this(l(t).keySeq())},De.prototype.toString=function(){return this.__toString("Set {","}")},De.prototype.has=function(t){return this._map.has(t)},De.prototype.add=function(t){return Oe(this,this._map.set(t,!0))},De.prototype.remove=function(t){return Oe(this,this._map.remove(t))},De.prototype.clear=function(){return Oe(this,this._map.clear())},De.prototype.union=function(){var t=an.call(arguments,0);return t=t.filter(function(t){return 0!==t.size}),0===t.length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations(function(e){for(var n=0;t.length>n;n++)_(t[n]).forEach(function(t){return e.add(t)})}):this.constructor(t[0])},De.prototype.intersect=function(){var t=an.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return _(t)});var e=this;return this.withMutations(function(n){e.forEach(function(e){t.every(function(t){return t.includes(e)})||n.remove(e)})})},De.prototype.subtract=function(){var t=an.call(arguments,0);if(0===t.length)return this;t=t.map(function(t){return _(t)});var e=this;return this.withMutations(function(n){e.forEach(function(e){t.some(function(t){return t.includes(e)})&&n.remove(e)})})},De.prototype.merge=function(){return this.union.apply(this,arguments)},De.prototype.mergeWith=function(){var t=an.call(arguments,1);return this.union.apply(this,t)},De.prototype.sort=function(t){return Pe(zt(this,t))},De.prototype.sortBy=function(t,e){return Pe(zt(this,e,t))},De.prototype.wasAltered=function(){return this._map.wasAltered()},De.prototype.__iterate=function(t,e){var n=this;return this._map.__iterate(function(e,r){return t(r,r,n)},e)},De.prototype.__iterator=function(t,e){return this._map.map(function(t,e){return e}).__iterator(t,e)},De.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map.__ensureOwner(t);return t?this.__make(e,t):(this.__ownerID=t,this._map=e,this)},De.isSet=Ce;var Zn="@@__IMMUTABLE_SET__@@",Qn=De.prototype;Qn[Zn]=!0,Qn[un]=Qn.remove,Qn.mergeDeep=Qn.merge,Qn.mergeDeepWith=Qn.mergeWith,Qn.withMutations=Ln.withMutations,Qn.asMutable=Ln.asMutable,Qn.asImmutable=Ln.asImmutable,Qn.__empty=Re,Qn.__make=qe;var tr;t(Pe,De),Pe.of=function(){return this(arguments)},Pe.fromKeys=function(t){return this(l(t).keySeq())},Pe.prototype.toString=function(){return this.__toString("OrderedSet {","}")},Pe.isOrderedSet=Ne;var er=Pe.prototype;er[mn]=!0,er.__empty=je,er.__make=Le;var nr;t(Ue,J),Ue.prototype.toString=function(){return this.__toString(We(this)+" {","}")},Ue.prototype.has=function(t){return this._defaultValues.hasOwnProperty(t)},Ue.prototype.get=function(t,e){if(!this.has(t))return e;var n=this._defaultValues[t];return this._map?this._map.get(t,n):n},Ue.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var t=this.constructor;return t._empty||(t._empty=Ke(this,Vt()))},Ue.prototype.set=function(t,e){if(!this.has(t))throw Error('Cannot set unknown key "'+t+'" on '+We(this));var n=this._map&&this._map.set(t,e);return this.__ownerID||n===this._map?this:Ke(this,n)},Ue.prototype.remove=function(t){if(!this.has(t))return this;var e=this._map&&this._map.remove(t);return this.__ownerID||e===this._map?this:Ke(this,e)},Ue.prototype.wasAltered=function(){return this._map.wasAltered()},Ue.prototype.__iterator=function(t,e){var n=this;return l(this._defaultValues).map(function(t,e){return n.get(e)}).__iterator(t,e)},Ue.prototype.__iterate=function(t,e){var n=this;return l(this._defaultValues).map(function(t,e){return n.get(e)}).__iterate(t,e)},Ue.prototype.__ensureOwner=function(t){if(t===this.__ownerID)return this;var e=this._map&&this._map.__ensureOwner(t);return t?Ke(this,e,t):(this.__ownerID=t,this._map=e,this)};var rr=Ue.prototype;rr[un]=rr.remove,rr.deleteIn=rr.removeIn=Ln.removeIn,rr.merge=Ln.merge,rr.mergeWith=Ln.mergeWith,rr.mergeIn=Ln.mergeIn,rr.mergeDeep=Ln.mergeDeep,rr.mergeDeepWith=Ln.mergeDeepWith,rr.mergeDeepIn=Ln.mergeDeepIn,rr.setIn=Ln.setIn,rr.update=Ln.update,rr.updateIn=Ln.updateIn,rr.withMutations=Ln.withMutations,rr.asMutable=Ln.asMutable,rr.asImmutable=Ln.asImmutable,t(Ge,T),Ge.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(this._step>1?" by "+this._step:"")+" ]"},Ge.prototype.get=function(t,e){return this.has(t)?this._start+s(this,t)*this._step:e},Ge.prototype.includes=function(t){var e=(t-this._start)/this._step;return e>=0&&this.size>e&&e===Math.floor(e)},Ge.prototype.slice=function(t,e){return u(t,e,this.size)?this:(t=c(t,this.size),e=h(e,this.size),t>=e?new Ge(0,0):new Ge(this.get(t,this._end),this.get(e,this._end),this._step))},Ge.prototype.indexOf=function(t){var e=t-this._start;if(e%this._step===0){var n=e/this._step;if(n>=0&&this.size>n)return n}return-1},Ge.prototype.lastIndexOf=function(t){return this.indexOf(t)},Ge.prototype.__iterate=function(t,e){for(var n=this.size-1,r=this._step,i=e?this._start+n*r:this._start,o=0;n>=o;o++){if(t(i,o,this)===!1)return o+1;i+=e?-r:r}return o},Ge.prototype.__iterator=function(t,e){var n=this.size-1,r=this._step,i=e?this._start+n*r:this._start,o=0;return new b(function(){var s=i;return i+=e?-r:r,o>n?S():k(t,o++,s)})},Ge.prototype.equals=function(t){return t instanceof Ge?this._start===t._start&&this._end===t._end&&this._step===t._step:Je(this,t)};var ir;t(Ve,T),Ve.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},Ve.prototype.get=function(t,e){return this.has(t)?this._value:e},Ve.prototype.includes=function(t){return Y(this._value,t)},Ve.prototype.slice=function(t,e){var n=this.size;return u(t,e,n)?this:new Ve(this._value,h(e,n)-c(t,n))},Ve.prototype.reverse=function(){return this},Ve.prototype.indexOf=function(t){return Y(this._value,t)?0:-1},Ve.prototype.lastIndexOf=function(t){return Y(this._value,t)?this.size:-1},Ve.prototype.__iterate=function(t){for(var e=0;this.size>e;e++)if(t(this._value,e,this)===!1)return e+1;return e},Ve.prototype.__iterator=function(t){var e=this,n=0;return new b(function(){return e.size>n?k(t,n++,e._value):S()})},Ve.prototype.equals=function(t){return t instanceof Ve?Y(this._value,t._value):Je(t)};var or;p.Iterator=b,Ye(p,{toArray:function(){at(this.size);var t=Array(this.size||0);return this.valueSeq().__iterate(function(e,n){t[n]=e}),t},toIndexedSeq:function(){return new ct(this)},toJS:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJS?t.toJS():t}).__toJS()},toJSON:function(){return this.toSeq().map(function(t){return t&&"function"==typeof t.toJSON?t.toJSON():t}).__toJS()},toKeyedSeq:function(){return new ut(this,!0)},toMap:function(){return Pt(this.toKeyedSeq())},toObject:function(){at(this.size);var t={};return this.__iterate(function(e,n){t[n]=e}),t},toOrderedMap:function(){return Se(this.toKeyedSeq())},toOrderedSet:function(){return Pe(y(this)?this.valueSeq():this)},toSet:function(){return De(y(this)?this.valueSeq():this)},toSetSeq:function(){return new ht(this)},toSeq:function(){return m(this)?this.toIndexedSeq():y(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Ae(y(this)?this.valueSeq():this)},toList:function(){return he(y(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(t,e){return 0===this.size?t+e:t+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+e},concat:function(){var t=an.call(arguments,0);return Mt(this,bt(this,t))},includes:function(t){return this.some(function(e){return Y(e,t)})},entries:function(){return this.__iterator(bn)},every:function(t,e){at(this.size);var n=!0;return this.__iterate(function(r,i,o){return t.call(e,r,i,o)?void 0:(n=!1,!1)}),n},filter:function(t,e){return Mt(this,_t(this,t,e,!0))},find:function(t,e,n){var r=this.findEntry(t,e);return r?r[1]:n},findEntry:function(t,e){var n;return this.__iterate(function(r,i,o){return t.call(e,r,i,o)?(n=[i,r],!1):void 0}),n},findLastEntry:function(t,e){return this.toSeq().reverse().findEntry(t,e)},forEach:function(t,e){return at(this.size),this.__iterate(e?t.bind(e):t)},join:function(t){at(this.size),t=void 0!==t?""+t:",";var e="",n=!0;return this.__iterate(function(r){n?n=!1:e+=t,e+=null!==r&&void 0!==r?""+r:""}),e},keys:function(){return this.__iterator(gn)},map:function(t,e){return Mt(this,lt(this,t,e))},reduce:function(t,e,n){at(this.size);var r,i;return arguments.length<2?i=!0:r=e,this.__iterate(function(e,o,s){i?(i=!1,r=e):r=t.call(n,r,e,o,s)}),r},reduceRight:function(){var t=this.toKeyedSeq().reverse();return t.reduce.apply(t,arguments)},reverse:function(){return Mt(this,dt(this,!0))},slice:function(t,e){return Mt(this,mt(this,t,e,!0))},some:function(t,e){return!this.every(Ze(t),e)},sort:function(t){return Mt(this,zt(this,t))},values:function(){return this.__iterator(wn)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some(function(){return!0})},count:function(t,e){return o(t?this.toSeq().filter(t,e):this)},countBy:function(t,e){return vt(this,t,e)},equals:function(t){return Je(this,t)},entrySeq:function(){var t=this;if(t._cache)return new C(t._cache);var e=t.toSeq().map(Xe).toIndexedSeq();return e.fromEntrySeq=function(){return t.toSeq()},e},filterNot:function(t,e){return this.filter(Ze(t),e)},findLast:function(t,e,n){return this.toKeyedSeq().reverse().find(t,e,n)},first:function(){return this.find(a)},flatMap:function(t,e){return Mt(this,St(this,t,e))},flatten:function(t){return Mt(this,kt(this,t,!0))},fromEntrySeq:function(){return new ft(this)},get:function(t,e){return this.find(function(e,n){return Y(n,t)},void 0,e)},getIn:function(t,e){for(var n,r=this,i=Rt(t);!(n=i.next()).done;){var o=n.value;if(r=r&&r.get?r.get(o,pn):pn,r===pn)return e}return r},groupBy:function(t,e){return yt(this,t,e)},has:function(t){return this.get(t,pn)!==pn},hasIn:function(t){return this.getIn(t,pn)!==pn},isSubset:function(t){return t="function"==typeof t.includes?t:p(t),this.every(function(e){return t.includes(e)})},isSuperset:function(t){return t="function"==typeof t.isSubset?t:p(t),t.isSubset(this)},keySeq:function(){return this.toSeq().map($e).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},max:function(t){return xt(this,t)},maxBy:function(t,e){return xt(this,e,t)},min:function(t){return xt(this,t?Qe(t):nn)},minBy:function(t,e){return xt(this,e?Qe(e):nn,t)},rest:function(){return this.slice(1)},skip:function(t){return this.slice(Math.max(0,t))},skipLast:function(t){return Mt(this,this.toSeq().reverse().skip(t).reverse())},skipWhile:function(t,e){return Mt(this,wt(this,t,e,!0))},skipUntil:function(t,e){return this.skipWhile(Ze(t),e)},sortBy:function(t,e){return Mt(this,zt(this,e,t))},take:function(t){return this.slice(0,Math.max(0,t))},takeLast:function(t){return Mt(this,this.toSeq().reverse().take(t).reverse())},takeWhile:function(t,e){return Mt(this,gt(this,t,e))},takeUntil:function(t,e){return this.takeWhile(Ze(t),e)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=rn(this))}});var sr=p.prototype;sr[_n]=!0,sr[In]=sr.values,sr.__toJS=sr.toArray,sr.__toStringMapper=tn,sr.inspect=sr.toSource=function(){return""+this},sr.chain=sr.flatMap,sr.contains=sr.includes,function(){try{Object.defineProperty(sr,"length",{get:function(){if(!p.noLengthWarning){var t;try{throw Error()}catch(e){t=e.stack}if(-1===t.indexOf("_wrapObject"))return console&&console.warn&&console.warn("iterable.length has been deprecated, use iterable.size or iterable.count(). This warning will become a silent error in a future version. "+t),this.size}}})}catch(t){}}(),Ye(l,{flip:function(){return Mt(this,pt(this))},findKey:function(t,e){var n=this.findEntry(t,e);return n&&n[0]},findLastKey:function(t,e){return this.toSeq().reverse().findKey(t,e)},keyOf:function(t){return this.findKey(function(e){return Y(e,t)})},lastKeyOf:function(t){return this.findLastKey(function(e){return Y(e,t)})},mapEntries:function(t,e){var n=this,r=0;return Mt(this,this.toSeq().map(function(i,o){return t.call(e,[o,i],r++,n)}).fromEntrySeq())},mapKeys:function(t,e){var n=this;return Mt(this,this.toSeq().flip().map(function(r,i){return t.call(e,r,i,n)}).flip())}});var ar=l.prototype;ar[vn]=!0,ar[In]=sr.entries,ar.__toJS=sr.toObject,ar.__toStringMapper=function(t,e){return JSON.stringify(e)+": "+tn(t)},Ye(d,{toKeyedSeq:function(){return new ut(this,!1)},filter:function(t,e){return Mt(this,_t(this,t,e,!1))},findIndex:function(t,e){var n=this.findEntry(t,e);return n?n[0]:-1},indexOf:function(t){var e=this.toKeyedSeq().keyOf(t);return void 0===e?-1:e},lastIndexOf:function(t){return this.toSeq().reverse().indexOf(t)},reverse:function(){return Mt(this,dt(this,!1))},slice:function(t,e){return Mt(this,mt(this,t,e,!1))},splice:function(t,e){var n=arguments.length;if(e=Math.max(0|e,0),0===n||2===n&&!e)return this;t=c(t,0>t?this.count():this.size);var r=this.slice(0,t);return Mt(this,1===n?r:r.concat(i(arguments,2),this.slice(t+e)))},findLastIndex:function(t,e){var n=this.toKeyedSeq().findLastKey(t,e);return void 0===n?-1:n},first:function(){return this.get(0)},flatten:function(t){return Mt(this,kt(this,t,!1))},get:function(t,e){return t=s(this,t),0>t||this.size===1/0||void 0!==this.size&&t>this.size?e:this.find(function(e,n){return n===t},void 0,e)},has:function(t){return t=s(this,t),t>=0&&(void 0!==this.size?this.size===1/0||this.size>t:-1!==this.indexOf(t))},interpose:function(t){return Mt(this,It(this,t))},interleave:function(){var t=[this].concat(i(arguments)),e=At(this.toSeq(),T.of,t),n=e.flatten(!0);return e.size&&(n.size=e.size*t.length),Mt(this,n)},last:function(){return this.get(-1)},skipWhile:function(t,e){return Mt(this,wt(this,t,e,!1))},zip:function(){var t=[this].concat(i(arguments));return Mt(this,At(this,en,t))},zipWith:function(t){var e=i(arguments);return e[0]=this,Mt(this,At(this,t,e))}}),d.prototype[yn]=!0,d.prototype[mn]=!0,Ye(_,{get:function(t,e){return this.has(t)?t:e},includes:function(t){return this.has(t)},keySeq:function(){return this.valueSeq()}}),_.prototype.has=sr.includes,Ye(B,l.prototype),Ye(T,d.prototype),Ye(D,_.prototype),Ye(J,l.prototype),Ye(G,d.prototype),Ye(V,_.prototype);var ur={Iterable:p,Seq:M,Collection:H,Map:Pt,OrderedMap:Se,List:he,Stack:Ae,Set:De,OrderedSet:Pe,Record:Ue,Range:Ge,Repeat:Ve,is:Y,fromJS:$};return ur});